import{x as c,z as d,h as y,m as w,e as h,y as C,v as x,S as $,A as D,c as I,s as L,o as M,B as k,D as v}from"./symbols-0f3de684.js";import{a as b}from"./Error-685fdf30.js";import{r as f,t as T}from"./typedArrayUtil-ce39e5f4.js";import{u as A}from"./layerUtils-0c01cb0c.js";const m={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function F(e,s=m){var i,p;if(!e)return{symbol:null};const{retainId:r=m.retainId,ignoreDrivers:n=m.ignoreDrivers,hasLabelingContext:t=m.hasLabelingContext,retainCIM:a=m.retainCIM}=s;let o=null;if(c(e)||e instanceof d)o=e.clone();else if(e.type==="cim"){const l=(p=(i=e.data)==null?void 0:i.symbol)==null?void 0:p.type;if(l!=="CIMPointSymbol")return{error:new b("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${l||"unknown"}' is unsupported in 3D`,{symbol:e})};o=a?e.clone():y.fromCIMSymbol(e)}else if(e instanceof w)o=h.fromSimpleLineSymbol(e);else if(e instanceof C)o=y.fromSimpleMarkerSymbol(e);else if(e instanceof x)o=y.fromPictureMarkerSymbol(e);else if(e instanceof $)o=s.geometryType&&s.geometryType==="mesh"?D.fromSimpleFillSymbol(e):I.fromSimpleFillSymbol(e);else{if(!(e instanceof L))return{error:new b("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};o=t?M.fromTextSymbol(e):y.fromTextSymbol(e)}if(r&&o&&o.type!=="cim"&&(o.id=e.id),n&&c(o))for(let l=0;l<o.symbolLayers.length;++l)o.symbolLayers.getItemAt(l)._ignoreDrivers=!0;return{symbol:o}}function z(e,s,r,n){const t=g(e,{},{context:n,isLabelSymbol:!1});f(t)&&(s[r]=t)}function B(e,s,r,n){const t=g(e,{},{context:n,isLabelSymbol:!0});f(t)&&(s[r]=t)}function u(e){return e instanceof k||e instanceof d}function g(e,s,r){if(T(e))return null;const{context:n,isLabelSymbol:t}=r,a=n==null?void 0:n.origin,o=n==null?void 0:n.messages;if(a==="web-scene"&&!u(e)){const i=F(e,{retainCIM:!0,hasLabelingContext:t});return f(i.symbol)?i.symbol.write(s,n):(o==null||o.push(new b("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:n,error:i.error})),null)}return(a==="web-map"||a==="portal-item"&&!A(n==null?void 0:n.layer))&&u(e)?(o==null||o.push(new b("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:n})),null):e.write(s,n)}function S(e,s){return v(e,null,s)}export{F as S,m as a,B as b,z as m,S as y};
