import"./geometry-f89ca072.js";import{e as V,y as G,s as It,a as Qt,l as tr}from"./JSONSupport-32b5ad86.js";import{i as rr}from"./Clonable-95fa5d2d.js";import{s as At}from"./Cyclical-34b2a5e3.js";import{O as ir,e as er,r as q,t as U}from"./typedArrayUtil-70e1d79e.js";import{a as Ct}from"./ensureType-249b88cd.js";import{g as z}from"./persistable-5845b8f0.js";import{w as sr}from"./Extent-2ad2c9a9.js";import{h as or}from"./string-7a2f1d87.js";import{s as nr}from"./Error-62cc7aff.js";import{m as ot,b as ar}from"./mathUtils-5b623c84.js";import{p as ft}from"./screenUtils-410d12c0.js";import{R as Ot,f as Dt,c as X,l as jt,r as vt,i as Rt,A as Nt,x as dr}from"./mat4-4714ff8c.js";import{e as ht}from"./mat4f64-abdda1bb.js";import{Q as Pt}from"./quat-99c4e099.js";import{r as I,a as N,s as P,o as nt,u as m,g as p,e as O,n as at,z as L,P as F,_ as C,t as cr,v as lr}from"./vec3-015ca254.js";import{z as ur}from"./projection-d42b91be.js";import{d as gr,c as d,e as Y,i as pr,o as Lt,n as St}from"./sphere-092242fd.js";import{_ as hr,$ as mr,R as fr,aX as ut,bc as zt,aY as B,aZ as v,bb as tt,aQ as br,bG as yt,bH as _r,bF as $r,bI as Or,bJ as Tr,G as qt,bC as Bt,bK as bt,bE as Er,bL as wr}from"./index-8cd323f3.js";import{_ as Xt,O as Yt}from"./plane-fef3662c.js";import{e as Z,r as x}from"./vec4f64-6d0e93be.js";import{n as Ir,g as Ar,b as Cr}from"./LineVisualElement-5f8bc514.js";import{V as vr,i as Zt,e as w,x as Rr,U as Nr}from"./manipulatorUtils-4499f155.js";import{a as Mt}from"./vec4-c7a19f0d.js";import{E as Pr,g as _}from"./VisualVariablePassParameters-ded3d86d.js";import{h as Lr}from"./Matrix3PassUniform-285be0f9.js";import{t as Sr}from"./ShaderTechniqueConfiguration-5b4afc58.js";import{B as yr,E as Mr,d as Vr}from"./objectResourceUtils-f1a10a8c.js";import{_ as Ur}from"./preload-helper-41c905a7.js";import{o as xr,a as Vt,n as Wr}from"./ShaderBuilder-c7fc4a30.js";import{t as kr,e as Hr,o as Gr,W as Fr,l as Dr,_ as jr}from"./EvaluateSceneLighting.glsl-ed7fcdc2.js";import{v as zr}from"./View.glsl-725bf3cf.js";import{e as Ut}from"./Float4PassUniform-52993952.js";import{o as qr}from"./FloatPassUniform-8a52db3d.js";import{O as xt}from"./VertexAttribute-15d1866a.js";import{R as rt,I as Br}from"./enums-fc527c7c.js";import{n as it}from"./basicInterfaces-7449a8bf.js";let T=class extends rr(tr){constructor(r){super(r),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(r){return this.heading===r.heading&&this.tilt===r.tilt&&ir(this.position,r.position)&&this.width===r.width&&this.height===r.height}};V([G({readOnly:!0,json:{read:!1,write:!0}})],T.prototype,"type",void 0),V([G({type:sr}),z()],T.prototype,"position",void 0),V([G({type:Number,nonNullable:!0,range:{min:0,max:360}}),z(),It(t=>At.normalize(Ct(t),0,!0))],T.prototype,"heading",void 0),V([G({type:Number,nonNullable:!0,range:{min:0,max:360}}),z(),It(t=>At.normalize(Ct(t),0,!0))],T.prototype,"tilt",void 0),V([G({type:Number,nonNullable:!0}),z()],T.prototype,"width",void 0),V([G({type:Number,nonNullable:!0}),z()],T.prototype,"height",void 0),T=V([Qt("esri.analysis.SlicePlane")],T);const Xr=T,fe=or("mac")?"Meta":"Control",be="Shift",Yr=2,Zr=1.15,Jr=1.15,_e=2500,$e=.02,Kr=Math.cos(ot(45)),Wt=Math.cos(ot(5)),Oe=.95,Te=.3,Qr=.7,J=I(1,.5,0),Ee=2,ti=1,ri=Z([...J,Qr]),ii=[0,0,0,.04],ei=Z([...J,.5]),si=x(1,1,1,1),oi=x(1,.8,.6,1),ni=x(1,.93,.86,1),ai=Z([...J,1]),di=Z([...J,1]),ci=3,Jt=11,_t=22.5,st=40,kt=48,li=2.25,ui=Z([...J,1]),gi=4,Ht=1,pi=.3,hi=6,mi=4,Gt=1600,fi=.4;function bi(t){const r=new xr;r.extensions.add("GL_OES_standard_derivatives");const{vertex:i,fragment:s,attributes:o,varyings:n}=r;return zr(i,t),o.add(xt.POSITION,"vec3"),o.add(xt.UV0,"vec2"),n.add("vUV","vec2"),i.code.add(Vt`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add([new Ut("backgroundColor",e=>e.backgroundColor),new Ut("gridColor",e=>e.gridColor),new qr("gridWidth",e=>e.gridWidth)]),s.code.add(Vt`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),r}const _i=Object.freeze(Object.defineProperty({__proto__:null,build:bi},Symbol.toStringTag,{value:"Module"}));let $i=class extends Wr{constructor(){super(...arguments),this.backgroundColor=x(1,0,0,.5),this.gridColor=x(0,1,0,.5),this.gridWidth=4}};class gt extends Hr{initializeProgram(r){return new Gr(r.rctx,gt.shader.get().build(this.configuration),Pr)}initializePipeline(){return Fr({blending:Dr(rt.ONE,rt.ONE,rt.ONE_MINUS_SRC_ALPHA,rt.ONE_MINUS_SRC_ALPHA),depthTest:{func:Br.LESS},colorWrite:jr})}}gt.shader=new kr(_i,()=>Ur(()=>import("./SlicePlaneMaterial.glsl-f096bed0.js"),["./SlicePlaneMaterial.glsl-f096bed0.js","./View.glsl-725bf3cf.js","./mat4-4714ff8c.js","./vec3-015ca254.js","./common-d0b63c2d.js","./mat4f32-60a2394b.js","./ShaderBuilder-c7fc4a30.js","./typedArrayUtil-70e1d79e.js","./Error-62cc7aff.js","./string-7a2f1d87.js","./VertexAttribute-15d1866a.js","./geometry-f89ca072.js","./ensureType-249b88cd.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./typeUtils-05f9d41d.js","./Clonable-95fa5d2d.js","./Cyclical-34b2a5e3.js","./mathUtils-5b623c84.js","./vec4-c7a19f0d.js","./persistable-5845b8f0.js","./preload-helper-41c905a7.js","./multiOriginJSONSupportUtils-c978f4c3.js","./request-f01affa1.js","./uuid-73213768.js","./resourceExtension-58c3e69d.js","./persistableUrlUtils-ccf13db2.js","./screenUtils-410d12c0.js","./mat4f64-abdda1bb.js","./quat-99c4e099.js","./mat3f64-50f3b9f6.js","./quatf64-f8f1c132.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./assets-640b4d04.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./sphere-092242fd.js","./vec4f64-6d0e93be.js","./byteSizeEstimations-f0cab514.js","./vec2f64-f35767d6.js","./index-8cd323f3.js","./IdentityManager-844d980b.js","./Evented-36093e88.js","./reactiveUtils-e6d6c898.js","./intl-0ee83c79.js","./number-2db5f4a2.js","./locale-30120714.js","./messages-f54f7f46.js","./Promise-3959c3ee.js","./dom-2ec1e33c.js","./Graphic-46941d56.js","./PopupTemplate-c1fb66ed.js","./Collection-9e42cc30.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./enumeration-504d95a2.js","./Identifiable-99d92428.js","./symbols-5a102dff.js","./CIMSymbol-561444b9.js","./Color-5a385b27.js","./colorUtils-639f4d25.js","./opacityUtils-c0957a27.js","./symbolLayerUtils3D-5a2f49a8.js","./aaBoundingBox-dfb04110.js","./Symbol3DAnchorPosition2D-d0207ef9.js","./collectionUtils-61fc1a27.js","./Portal-52d960e8.js","./Loadable-7c3ecd79.js","./PortalGroup-b49a7409.js","./PortalUser-85cf1ca9.js","./jsonUtils-6d0a72e3.js","./workers-591e0dfc.js","./Connection-000cba43.js","./GraphicsLayer-78551f17.js","./HandleOwner-f4554d8c.js","./Layer-ab90f8be.js","./BlendLayer-fe49ee20.js","./ScaleRangeLayer-56857dcb.js","./ElevationInfo-bc15f954.js","./lengthUtils-e2d3809d.js","./HeightModelInfo-bc3bd77c.js","./lineSegment-8ffcb750.js","./plane-fef3662c.js","./spatialReferenceEllipsoidUtils-26c8dea5.js","./scaleUtils-b27f2fc2.js","./layerUtils-ff76096c.js","./AttachmentInfo-2774f92c.js","./AttachmentQuery-be73c1f4.js","./LegendOptions-d1ee6f9f.js","./DimensionalDefinition-89a02a09.js","./UniqueValueRenderer-31cfe725.js","./diffUtils-a2efee1b.js","./colorRamps-844ba070.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-6f78f1dd.js","./compilerUtils-2eb56463.js","./jsonUtils-ba20c384.js","./styleUtils-ba5d50e4.js","./vectorFieldUtils-b0aae2f9.js","./colorUtils-7641d345.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./asyncUtils-8de18dd2.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./cimSymbolUtils-12c2ae8a.js","./utils-3d986af0.js","./jsonUtils-0cd7beab.js","./DictionaryLoader-e5256637.js","./LRUCache-805da42e.js","./deprecate-2ea4a12e.js","./heatmapUtils-bc76f08e.js","./Query-6df7497c.js","./TimeExtent-4bfae662.js","./Field-efd8d6fa.js","./fieldType-ec749512.js","./executeQueryJSON-c3e8823f.js","./query-159ca0c6.js","./pbfQueryUtils-e595cc71.js","./pbf-490f560a.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-7c3cd57e.js","./FeatureSet-adc6c42d.js","./featureConversionUtils-66a9b1ed.js","./RelationshipQuery-1388e5e8.js","./TopFeaturesQuery-c51356f1.js","./FeatureLayer-c3299dce.js","./MultiOriginJSONSupport-247be6b9.js","./serviceCapabilitiesUtils-d47be03f.js","./arcgisLayerUrl-1177870a.js","./FeatureLayerBase-4bc86305.js","./OperationalLayer-892ef1ff.js","./TimeReference-dbe22fa2.js","./datetime-b6333958.js","./editsZScale-1f9f5428.js","./APIKeyMixin-a999140b.js","./ArcGISService-69574b36.js","./CustomParametersMixin-0cb5d402.js","./EditBusLayer-40721674.js","./FeatureReductionLayer-5d021257.js","./labelingInfo-81f8350c.js","./labelUtils-2517fbb8.js","./defaultsJSON-59981e75.js","./OrderedLayer-e39f681d.js","./PortalLayer-f8afa381.js","./PortalItem-476b4f2f.js","./portalItemUtils-f08de884.js","./RefreshableLayer-6e09e5c7.js","./TemporalLayer-1cafdc62.js","./FeatureTemplate-c492af3e.js","./FeatureType-9aee1062.js","./fieldProperties-13016a3b.js","./FieldsIndex-3347fdc5.js","./versionUtils-3b55ef95.js","./styleUtils-a2cb1d02.js","./popupUtils-ef59e204.js","./callExpressionWithFeature-b2780134.js","./quantizationUtils-5accf704.js","./webStyleSymbolUtils-7af9b968.js","./devEnvironmentUtils-5002a058.js","./Scheduler-22864fbd.js","./ElevationSamplerData-89295dc0.js","./TileInfo-c1a6fc90.js","./Basemap-a98ee4eb.js","./loadAll-b0bbaf30.js","./writeUtils-054a51f5.js","./CollectionFlattener-53f524d1.js","./TablesMixin-d0eb7f9b.js","./ViewingMode-5d7d590b.js","./vec2-8acac370.js","./PhysicallyBasedRendering.glsl-d72e2a11.js","./FloatPassUniform-8a52db3d.js","./Float4PassUniform-52993952.js","./RgbaFloatEncoding.glsl-31b2b966.js","./Texture2DPassUniform-1510cbb0.js","./vec3f32-01c06d8d.js","./Texture2DDrawUniform-d1eaa0d6.js","./basicInterfaces-7449a8bf.js","./PiUtils.glsl-9dc0973a.js","./ReadLinearDepth.glsl-9abddde9.js","./WaterSurface.glsl-ad07df19.js","./ForwardLinearDepth.glsl-3606f02d.js","./Matrix3PassUniform-285be0f9.js","./Slice.glsl-e5fdd8d3.js","./Transform.glsl-e6366353.js","./OutputHighlight.glsl-569dde3f.js","./MultipassTerrainTest.glsl-029ffa3f.js","./NormalUtils.glsl-d1e61521.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-a1cb0602.js","./EvaluateSceneLighting.glsl-ed7fcdc2.js","./VisualVariablePassParameters-ded3d86d.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js","./Texture-42bd3a76.js","./context-util-eb98c678.js","./Util-c12e93ba.js","./SSAOBlur.glsl-2bfd75b0.js","./ScreenSpacePass.glsl-28a2b6e5.js","./SSAO.glsl-1d087e8c.js","./ShaderTechniqueConfiguration-5b4afc58.js","./mat3-4fd89d48.js","./HUD.glsl-03dc2889.js","./VerticalOffset.glsl-2b654767.js","./Octree-fac2eadb.js","./objectResourceUtils-f1a10a8c.js","./BufferView-da65c548.js","./vec33-6cea25ab.js","./DefaultMaterial_COLOR_GAMMA-8afda99b.js","./types-e1c0a5bf.js","./Version-b7702d36.js","./resourceUtils-527631ac.js","./Indices-7097baff.js","./DefaultMaterial.glsl-0c704a85.js","./MixExternalColor.glsl-96fc9ef8.js","./symbolColorUtils-7c94928f.js","./ObjectAndLayerIdColor.glsl-751e40ac.js","./OutputDepth.glsl-ccbc6366.js","./VisualVariables.glsl-655a358f.js","./DiscardOrAdjustAlphaBlend.glsl-27b032af.js","./VertexColor.glsl-e2eb2da5.js","./Normals.glsl-81bc0899.js","./vec2f32-eaf29605.js","./Texture-2b2e584f.js","./TextureOnly.glsl-12d60c43.js","./Attribute-f72d3f37.js","./InterleavedLayout-d75b8228.js","./DefaultTechniqueConfiguration-d3c0bf46.js","./RealisticTree.glsl-f514fb19.js","./edgeProcessing-9fe73f05.js","./deduplicate-3aef92f2.js","./MeshComponent-76cc0acf.js","./earcut-61f7b102.js","./projection-720a032f.js","./HUDMaterial.glsl-bcc90ab4.js","./sdfPrimitives-16d07d48.js","./floatRGBA-11065dbc.js","./dehydratedFeatures-be6dfdbf.js","./labelFormatUtils-deccc57b.js","./orientedBoundingBox-7f391048.js","./quatf32-51a323b8.js","./LineCallout.glsl-828f2c8d.js","./QueryEngineResult-60e819c8.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./json-48e3ea08.js","./MarkerSizing.glsl-1e815ddd.js","./RibbonLine.glsl-3b5ffb4c.js","./LineStipple.glsl-df787c01.js","./LineMarker.glsl-af47e9ca.js","./NativeLine.glsl-eddd3297.js","./Path.glsl-98387e31.js","./ColorMaterial.glsl-2f16b93b.js","./Pattern.glsl-3d1048ed.js","./LercDecoder-bc94632d.js","./enums-fb086c25.js","./config-f7904f35.js","./TileKey-5f02dc79.js","./workerHelper-7b69330e.js","./capabilities-ef053cf2.js","./originUtils-1469eeaf.js","./saveUtils-44b7e317.js","./resourceUtils-a295dbcf.js","./floating-ui-8c8de742.js","./StreamLayer-869211a2.js","./geometryEngine-5399ce6b.js","./geometryEngineBase-e1a33b0a.js","./hydrated-d446f5f6.js","./SceneFilter-9f7d00a7.js","./elevationInfoUtils-cb162a43.js","./DimensionAnalysis-26fb1362.js","./Analysis-ba6617ff.js","./ExportImageParameters-1fbdfa05.js","./sublayerUtils-1d562031.js","./index-2f6aec2e.css","./LineVisualElement-5f8bc514.js","./manipulatorUtils-4499f155.js","./ImageMaterial-4e661db5.js","./ImageMaterial.glsl-44b698e0.js","./ShadedColorMaterial.glsl-e70bd616.js"],import.meta.url));class Oi extends hr{constructor(r){super(r,new Ei),this._configuration=new Sr}createBufferWriter(){return new yr(mr)}requiresSlot(r,i){return i===Lr.Color&&r===Mr.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(r){return new Ti(r)}getConfiguration(){return this._configuration}}class Ti extends Vr{constructor(r){super(r),this.ensureTechnique(gt,null)}beginSlot(){return er(this.technique)}}class Ei extends $i{constructor(){super(...arguments),this.renderOccluded=_.Occlude}}class wi extends Ir{constructor(r){super(r),this._material=null,this._renderOccluded=_.OccludeAndTransparent,this._gridWidth=1,this._gridColor=x(1,0,0,1),this._backgroundColor=x(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){Mt(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){Mt(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new Oi(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(r){q(this._material)&&r(this._material)}createGeometries(r){if(q(this._material)){const i=fr(this._material);r.addGeometry(i)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){q(this._material)&&this._material.setParameters(this._materialParameters)}}function Ie(t,r,i,s,o,n,e,a){return Ii(r,e.worldUpAtPosition(t,d.get()),o,n,a.basis1,a.basis2),p(a.basis1,a.basis1,i),p(a.basis2,a.basis2,s),N(a.origin,t),Yt(a.basis2,a.basis1,a.origin,a.plane),a}function Ii(t,r,i,s,o,n){const e=F(t,r),a=d.get(),c=d.get();switch(s===R.HORIZONTAL_OR_VERTICAL?Math.abs(e)>Kr?R.HORIZONTAL:R.VERTICAL:s){case R.VERTICAL:{const l=Math.abs(e)<=Wt?t:i.viewUp;C(a,l,r),N(c,r);break}case R.HORIZONTAL:C(a,i.viewUp,r),C(c,r,a);break;case R.TILTED:{const l=Math.abs(e)<=Wt?r:i.viewUp;C(a,l,t),C(c,t,a);break}}const g=C(d.get(),a,c);F(g,i.viewForward)>0&&p(c,c,-1),L(o,a),L(n,c)}function Ai(t,r,i){const s=r.worldUpAtPosition(t.origin,d.get()),o=t.basis1,n=wt(t,s),e=Math.round(n/D)*D;return bt(t,e-n,o,i)}function Ae(t,r,i,s,o,n){const e=N(d.get(),o.origin);m(e,e,p(d.get(),o.basis1,t.direction[0]<0?1:-1)),m(e,e,p(d.get(),o.basis2,t.direction[1]<0?1:-1));const a=P(o.basis1),c=P(o.basis2),g=O(d.get(),i,e),l=O(d.get(),r,e);let u=0,h=0;if(Et(t)){const K=$t(o),y=$t(n);u=a-.5*t.direction[0]*F(o.basis1,l)/a,h=c-.5*t.direction[1]*F(o.basis2,l)/c;const k=y/K;u*=k,h*=k}const $=u+.5*t.direction[0]*F(o.basis1,g)/a,b=h+.5*t.direction[1]*F(o.basis2,g)/c,W=p(d.get(),o.basis1,$/a),S=p(d.get(),o.basis2,b/c);($<=0||Ft(n.origin,W,s)<=Gt)&&N(W,n.basis1),(b<=0||Ft(n.origin,S,s)<=Gt)&&N(S,n.basis2);const f=N(d.get(),e);return m(f,f,p(d.get(),W,t.direction[0]<0?-1:1)),m(f,f,p(d.get(),S,t.direction[1]<0?-1:1)),$r(f,W,S,n)}function Ce(t,r){return fi*Math.min(r.width,r.height)*r.computeRenderPixelSizeAt(t)}function ve(t,r,i,s){const o=C(d.get(),r,i);return C(o,o,r),Xt(t,o,s)}function Re(t,r){return vr(t.basis1,t.basis2,t.origin,r)}function Ne(t,r,i,s){const o=r.worldUpAtPosition(t.origin,d.get()),n=d.get();switch(i){case dt.HEADING:N(n,o);break;case dt.TILT:N(n,t.basis1)}return Xt(t.origin,n,s)}function Pe(t,r,i,s){const o=Tt(i,A.NEGATIVE_X),n=Y.get();dr(n,r,o.edge*Math.PI/2);const e=L(d.get(),o.basis);let a=p(d.get(),e,o.direction*s.computeScreenPixelSizeAt(o.position)*st);m(a,a,o.position);const c=s.projectToRenderScreen(a,ft(d.get())),g=Ci(s,c);Or(s,c,et),L(et.direction,et.direction);const l=d.get();!g&&Tr(i,et,l)&&(a=l),n[12]=0,n[13]=0,n[14]=0,t.modelTransform=n,t.renderLocation=cr(a),g?t.state|=ct:t.state&=~ct}function Ci(t,r){const[i,s,o,n]=t.viewport,e=Math.min(o,n)/16;let a=!0;return r[0]<i+e?(r[0]=i+e,a=!1):r[0]>i+o-e&&(r[0]=i+o-e,a=!1),r[1]<s+e?(r[1]=s+e,a=!1):r[1]>s+n-e&&(r[1]=s+n-e,a=!1),a}function Le(t,r,i,s){const o=P(s.basis1),n=P(s.basis2),e=Kt(s),a=$t(s),c=nt(d.get(),0,0,0);m(c,p(d.get(),s.basis1,r.direction[0]),p(d.get(),s.basis2,r.direction[1])),m(c,s.origin,c);let g=0,l=1;if(Et(r))r.direction[0]===1&&r.direction[1]===-1?g=D:r.direction[0]===1&&r.direction[1]===1?g=Math.PI:r.direction[0]===-1&&r.direction[1]===1&&(g=3*Math.PI/2),l=a;else{const h=r.direction[0]!==0?1:2;g=h===1?D:0,l=(h===1?n:o)-e}const u=Ot(Y.get(),g);Dt(u,u,nt(d.get(),l,l,l)),X(u,i,u),u[12]=0,u[13]=0,u[14]=0,t.modelTransform=u,t.renderLocation=c}function Se(t,r,i,s){const o=s.worldUpAtPosition(i.origin,d.get()),n=Tt(i,A.POSITIVE_X),e=Ot(Y.get(),n.edge*Math.PI/2);jt(e,e,-wt(i,o)),X(e,r,e),e[12]=0,e[13]=0,e[14]=0,t.modelTransform=e,t.renderLocation=n.position}function ye(t,r,i){const s=Tt(i,A.POSITIVE_Y),o=Ot(Y.get(),s.edge*Math.PI/2);jt(o,o,D),X(o,r,o),o[12]=0,o[13]=0,o[14]=0,t.modelTransform=o,t.renderLocation=s.position}var A;function Tt(t,r){switch(r){case A.POSITIVE_X:return{basis:t.basis1,direction:1,position:m(d.get(),t.origin,t.basis1),edge:r};case A.POSITIVE_Y:return{basis:t.basis2,direction:1,position:m(d.get(),t.origin,t.basis2),edge:r};case A.NEGATIVE_X:return{basis:t.basis1,direction:-1,position:O(d.get(),t.origin,t.basis1),edge:r};case A.NEGATIVE_Y:return{basis:t.basis2,direction:-1,position:O(d.get(),t.origin,t.basis2),edge:r}}}function Ft(t,r,i){const s=i.projectToRenderScreen(m(d.get(),t,r),ft(d.get())),o=i.projectToRenderScreen(O(d.get(),t,r),ft(d.get()));return lr(O(s,s,o))}function Kt(t){const r=P(t.basis1),i=P(t.basis2);return pi*Math.min(r,i)}function $t(t){return Kt(t)}function Et(t){return t.direction[0]!==0&&t.direction[1]!==0}function Me(t,r=lt.CENTER_ON_ARROW){const i=r===lt.CENTER_ON_CALLOUT?st:0,s=[I(i,0,-kt/2),I(i,0,kt/2)],o=Ni(s,!0),n=(u,h)=>vi(s,u,h),e=n(0,!1),a=n(li,!0),c=new zt({color:ai,renderOccluded:_.OccludeAndTransparent}),g=B(c,[[i,0,0],[i-st,0,0]]),l=B(c,[[i,0,0],[i-st,0,0]]);return new Zt({view:t,renderObjects:[...e.normal.map(u=>new w(u,v.Unfocused|E)),...a.normal.map(u=>new w(u,v.Unfocused|E)),new w(g,v.Unfocused|E|ct),...e.focused.map(u=>new w(u,v.Focused|E)),...a.focused.map(u=>new w(u,v.Focused|E)),new w(l,v.Focused|E|ct)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[o]},collisionPriority:1,radius:Jt,state:E})}function Ve(t,r){const i=Nr(t,{customStateMask:E,texture:r});return i.state=E,i}function Ue(t){const r=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ar({view:t,attached:!1,color:ri,width:ti,writeDepthEnabled:!1,renderOccluded:_.OccludeAndTransparent,geometry:[r]})}function xe(t){return new wi({view:t,attached:!1,backgroundColor:[...ii],gridColor:ei,gridWidth:4,renderOccluded:_.OccludeAndTransparent})}function We(t,r){const i=Et(r),s=i?[I(1,0,0),I(0,0,0),I(0,1,0)]:[I(1,0,0),I(-1,0,0)],o=ui,n=$=>new br({color:o,width:$,renderOccluded:_.OccludeAndTransparent}),e=()=>new zt({color:o,renderOccluded:_.OccludeAndTransparent}),a=i?gi:Ht,c=a*Yr,g=Ht,l=$=>$>1?n($):e(),u=[new w(B(l(a),s),v.Unfocused|mt),new w(B(l(c),s),v.Focused|mt),new w(B(l(g),s),Li)],h=new Zt({view:t,renderObjects:u,collisionType:{type:"line",paths:[s]},radius:i?hi:mi,...Rr});return h.state=mt,h}function vi(t,r,i){const s=new tt({color:si,cullFace:it.Back,renderOccluded:_.Opaque}),o=new tt({color:oi,cullFace:it.Back,renderOccluded:_.Opaque}),n=new tt({color:ni,cullFace:it.Back,renderOccluded:_.Opaque}),e=new tt({color:di,transparent:!0,writeDepth:!1,cullFace:it.Front,renderOccluded:_.Transparent}),a=c=>{t=t.slice(0);const g=O(d.get(),t[0],t[1]);L(g,g);const l=O(d.get(),t[t.length-1],t[t.length-2]);if(L(l,l),r>0){const j=p(at(),l,-r);t[t.length-1]=m(j,j,t[t.length-1]);const H=p(at(),g,-r);t[0]=m(H,H,t[0])}const u=c?Jr:1,h=_t*u,$=Jt*u,b=vt(Y.get());if(r>0){const j=h/4,H=nt(d.get(),0,j,0),Q=1+r/j;Rt(b,b,H),Dt(b,b,nt(d.get(),Q,Q,Q)),Rt(b,b,p(H,H,-1/Q))}const W=vt(ht()),S=I(0,1,0),f=Nt(ht(),Pt(Lt.get(),S,l));f[12]=t[t.length-1][0],f[13]=t[t.length-1][1],f[14]=t[t.length-1][2],X(f,f,b);const K=Ri(ci*(c?Zr:1)+r,t,i?e:n);K.transformation=W;const y=[K],k=yt(i?e:s,h,$,24,!1,!1,!0);k.transformation=f,y.push(k);const pt=yt(i?e:o,h,$,24,!1,!0,!1);pt.transformation=f,y.push(pt);const M=Nt(ht(),Pt(Lt.get(),S,g));return M[12]=t[0][0],M[13]=t[0][1],M[14]=t[0][2],X(M,M,b),y.push(k.instantiate({transformation:M})),y.push(pt.instantiate({transformation:M})),y};return{normal:a(!1),focused:a(!0)}}function Ri(t,r,i){const s=[];for(let n=0;n<12;n++){const e=n/12*2*Math.PI;s.push([Math.cos(e)*t,Math.sin(e)*t])}return _r(i,s,r,[],[],!1)}function Ni(t,r){const i=O(at(),t[t.length-1],t[t.length-2]);if(L(i,i),p(i,i,_t),m(i,i,t[t.length-1]),r){const s=O(at(),t[0],t[1]);return L(s,s),p(s,s,_t),m(s,s,t[0]),[s,...t,i]}return[...t,i]}function ke(t,r,i,s=new Xr){if(U(t))return null;const{renderCoordsHelper:o}=r,n=o.fromRenderCoords(t.origin,r.spatialReference);if(U(n))return null;const e=ur(n,i);if(U(e))return null;s.position=e;const a=2*P(t.basis1),c=2*P(t.basis2),g=qt.renderUnitScaleFactor(r.spatialReference,i);s.width=a*g,s.height=c*g;const l=o.worldUpAtPosition(t.origin,d.get());return s.tilt=ar(wt(t,l)),s.heading=o.headingAtPosition(t.origin,t.basis1)-90,s}function wt(t,r){return pr(r,t.basis2,t.basis1)+D}function Pi(t,r,i,s,o,n,e=Bt()){return n.toRenderCoords(t,e.origin)?(n.worldBasisAtPosition(e.origin,St.X,e.basis1),n.worldBasisAtPosition(e.origin,St.Y,e.basis2),Yt(e.basis2,e.basis1,e.origin,e.plane),bt(e,-ot(r),Er(e),e),bt(e,ot(i),e.basis1,e),p(e.basis1,e.basis1,s/2),p(e.basis2,e.basis2,o/2),wr(e),e):(nr.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${t.spatialReference.wkid} is not supported`),null)}function He(t,r){if(U(t)||U(t.position))return null;const i=Cr(t.position,r.spatialReference,r.elevationProvider);if(U(i))return null;const s=qt.renderUnitScaleFactor(t.position.spatialReference,r.spatialReference),o=t.width*s,n=t.height*s;return{position:i,heading:t.heading,tilt:t.tilt,renderWidth:o,renderHeight:n}}function Ge(t,r,i,s=Bt()){if(U(t))return null;const o=Pi(t.position,t.heading,t.tilt,t.renderWidth,t.renderHeight,r.renderCoordsHelper,s);return!i.tiltEnabled&&q(o)&&Ai(o,r.renderCoordsHelper,o),o}(function(t){t[t.POSITIVE_X=0]="POSITIVE_X",t[t.POSITIVE_Y=1]="POSITIVE_Y",t[t.NEGATIVE_X=2]="NEGATIVE_X",t[t.NEGATIVE_Y=3]="NEGATIVE_Y"})(A||(A={}));const E=ut.Custom1;var dt,R;(function(t){t[t.HEADING=1]="HEADING",t[t.TILT=2]="TILT"})(dt||(dt={})),function(t){t[t.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.TILTED=3]="TILTED"}(R||(R={}));const ct=ut.Custom2,et=gr(),D=Math.PI/2,mt=ut.Custom1,Li=ut.Custom2;var lt;function Fe(t){const r=t.type==="building-scene-3d"?t:null;return q(r)}(function(t){t[t.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",t[t.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(lt||(lt={}));export{Re as B,ei as C,E,Ie as G,dt as I,Le as J,Se as K,Te as M,lt as N,Ge as O,Fe as P,ye as Q,R,He as T,ve as W,Ae as Y,Ce as Z,mt as _,Ve as a,Ee as b,Ue as c,fe as d,_e as e,ri as f,ke as g,Xr as h,$e as i,ct as j,Li as k,xe as l,be as m,Oe as n,$t as o,Ne as q,Et as r,Me as s,bi as t,We as u,ti as v,ii as x,Pe as z};
