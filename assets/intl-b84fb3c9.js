import{m as c,L as u}from"./number-134e9f14.js";import{s as y,a as m}from"./Error-685fdf30.js";import{n as L,t as U}from"./string-7a324480.js";import"./locale-30120714.js";import{h as R,l as x}from"./messages-8a541332.js";import{U as B}from"./request-fc61835a.js";import{r as k}from"./typedArrayUtil-ce39e5f4.js";import{a as A}from"./assets-5052bbaa.js";const $=y.getLogger("esri.intl.substitute");function z(t,e,n={}){const{format:r={}}=n;return L(t,o=>O(o,e,r))}function O(t,e,n){let r,o;const s=t.indexOf(":");if(s===-1?r=t.trim():(r=t.slice(0,s).trim(),o=t.slice(s+1).trim()),!r)return"";const i=U(r,e);if(i==null)return"";const a=(o?n==null?void 0:n[o]:null)??(n==null?void 0:n[r]);return a?j(i,a):o?E(i,o):d(i)}function j(t,e){switch(e.type){case"date":return u(t,e.intlOptions);case"number":return c(t,e.intlOptions);default:return $.warn("missing format descriptor for key {key}"),d(t)}}function E(t,e){switch(e.toLowerCase()){case"dateformat":return u(t);case"numberformat":return c(t);default:return $.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?u(t):/^numberformat/i.test(e)?c(t):d(t)}}function d(t){switch(typeof t){case"string":return t;case"number":return c(t);case"boolean":return""+t;default:return t instanceof Date?u(t):""}}async function v(t,e,n,r){const o=e.exec(n);if(!o)throw new m("esri-intl:invalid-bundle",`Bundle id "${n}" is not compatible with the pattern "${e}"`);const s=o[1]?`${o[1]}/`:"",i=o[2],a=R(r),f=`${s}${i}.json`,w=a?`${s}${i}_${a}.json`:f;let l;try{l=await p(t(w))}catch(b){if(w===f)throw new m("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:b});try{l=await p(t(f))}catch(g){throw new m("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:g})}}return l}async function p(t){if(k(h.fetchBundleAsset))return h.fetchBundleAsset(t);const e=await B(t,{responseType:"text"});return JSON.parse(e.data)}class C{constructor({base:e="",pattern:n,location:r=new URL(window.location.href)}){let o;o=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof n=="string"?new RegExp(`^${n}`):n,this.getAssetUrl=o,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,n){return v(this.getAssetUrl,this.matcher,e,n)}}function D(t){return new C(t)}const h={};x(D({pattern:"esri/",location:A}));export{z as s};
