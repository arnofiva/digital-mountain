import{w}from"./JSONSupport-32b5ad86.js";import{a as v,d as R,c as J,s as T}from"./Error-62cc7aff.js";import{p as j,a as f,v as W,C as N,j as C,r as D,A as V,f as $}from"./promiseUtils-59dab60c.js";import{N as P,p as E,r as B}from"./typedArrayUtil-70e1d79e.js";import{_ as h}from"./preload-helper-41c905a7.js";import{a as H}from"./request-f01affa1.js";import{h as M}from"./string-7a2f1d87.js";let Q=class{constructor(e=t=>t.values().next().value){this._peeker=e,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}last(){if(this._items.size===0)return;let e;for(e of this._items);return e}peek(){if(this._items.size!==0)return this._peeker(this._items)}push(e){this.contains(e)||this._items.add(e)}contains(e){return this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(P(e)),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(P(e)),e}remove(e){this._items.delete(e)}filter(e){return this._items.forEach(t=>{e(t)||this._items.delete(t)}),this}};var c;(function(o){o[o.HANDSHAKE=0]="HANDSHAKE",o[o.OPEN=1]="OPEN",o[o.OPENED=2]="OPENED",o[o.RESPONSE=3]="RESPONSE",o[o.INVOKE=4]="INVOKE",o[o.ABORT=5]="ABORT",o[o.CLOSE=6]="CLOSE",o[o.OPEN_PORT=7]="OPEN_PORT",o[o.ON=8]="ON"})(c||(c={}));let K=0;function x(){return K++}function z(o){return o&&typeof o=="object"&&("result"in o||"transferList"in o)}function b(o){return o?typeof o=="string"?JSON.stringify({name:"message",message:o}):o.toJSON?JSON.stringify(o):JSON.stringify({name:o.name,message:o.message,details:o.details||{stack:o.stack}}):null}function L(o,e,t,s){if(e.type===c.OPEN_PORT)return void o.postMessage(e,[e.port]);if(e.type!==c.INVOKE&&e.type!==c.RESPONSE)return void o.postMessage(e);let r;if(z(t)?(r=k(t.transferList),e.data=t.result):(r=k(s),e.data=t),r){if(M("ff")){for(const n of r)if("byteLength"in n&&n.byteLength>267386880){const i="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case c.INVOKE:throw i;case c.RESPONSE:return void L(o,{type:c.RESPONSE,jobId:e.jobId,error:b(i)})}}}o.postMessage(e,r)}else o.postMessage(e)}function O(o){if(!o)return null;const e=o.data;return e?typeof e=="string"?JSON.parse(e):e:null}function k(o){if(!o||!o.length)return null;if(M("esri-workers-arraybuffer-transfer"))return o;const e=o.filter(t=>!F(t));return e.length?e:null}function F(o){return o instanceof ArrayBuffer||o&&o.constructor&&o.constructor.name==="ArrayBuffer"}const U={statsWorker:()=>h(()=>import("./statsWorker-3261fea7.js"),["./statsWorker-3261fea7.js","./geometry-f89ca072.js","./ensureType-249b88cd.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./Error-62cc7aff.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./typeUtils-05f9d41d.js","./screenUtils-410d12c0.js","./quantizationUtils-5accf704.js","./fieldUtils-e397be4b.js","./preload-helper-41c905a7.js","./arcadeOnDemand-5c3ab3f7.js","./heatmapUtils-bc76f08e.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./vec4f64-6d0e93be.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js"],import.meta.url),geometryEngineWorker:()=>h(()=>import("./geometryEngineWorker-8a57eda3.js"),["./geometryEngineWorker-8a57eda3.js","./geometryEngineJSON-3f330436.js","./geometryEngineBase-e1a33b0a.js","./json-48e3ea08.js"],import.meta.url),CSVSourceWorker:()=>h(()=>import("./CSVSourceWorker-c0498409.js"),["./CSVSourceWorker-c0498409.js","./geometry-f89ca072.js","./ensureType-249b88cd.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./Error-62cc7aff.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./typeUtils-05f9d41d.js","./request-f01affa1.js","./preload-helper-41c905a7.js","./asyncUtils-8de18dd2.js","./projection-d42b91be.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./json-48e3ea08.js","./OptimizedFeature-cb86a86f.js","./FeatureStore-b6e7eda2.js","./Evented-36093e88.js","./aaBoundingBox-dfb04110.js","./featureConversionUtils-66a9b1ed.js","./jsonUtils-6d0a72e3.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-3597a01f.js","./PooledRBush-15b28b04.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-5596e92b.js","./centroid-31e9f7c2.js","./QueryEngineResult-60e819c8.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngine-146c01b4.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./reactiveUtils-e6d6c898.js","./number-9d73a551.js","./locale-30120714.js","./clientSideDefaults-6c382415.js","./defaultsJSON-59981e75.js"],import.meta.url),EdgeProcessingWorker:()=>h(()=>import("./EdgeProcessingWorker-0061d75b.js"),["./EdgeProcessingWorker-0061d75b.js","./workerHelper-7b69330e.js","./BufferView-da65c548.js","./vec2-8acac370.js","./common-d0b63c2d.js","./vec3-015ca254.js","./vec4-c7a19f0d.js","./InterleavedLayout-d75b8228.js","./types-e1c0a5bf.js","./edgeProcessing-9fe73f05.js","./deduplicate-3aef92f2.js","./mathUtils-5b623c84.js","./Indices-7097baff.js","./typedArrayUtil-70e1d79e.js","./VertexAttribute-15d1866a.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),ElevationSamplerWorker:()=>h(()=>import("./ElevationSamplerWorker-cf770b45.js"),["./ElevationSamplerWorker-cf770b45.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./PooledRBush-15b28b04.js","./JSONSupport-32b5ad86.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./quickselect-56c5966e.js","./georeference-435c942a.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./mat3f64-50f3b9f6.js","./mat4-4714ff8c.js","./vec3-015ca254.js","./common-d0b63c2d.js","./mat4f64-abdda1bb.js","./mat3-4fd89d48.js","./projection-d42b91be.js","./preload-helper-41c905a7.js","./mathUtils-5b623c84.js","./vec4-c7a19f0d.js","./SimpleObservable-a6d3d2d8.js","./Polyline-cf51ad23.js","./assets-640b4d04.js","./request-f01affa1.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./spatialReferenceEllipsoidUtils-26c8dea5.js","./quat-99c4e099.js","./quatf64-f8f1c132.js","./projection-720a032f.js","./BufferView-da65c548.js","./vec2-8acac370.js","./vec33-6cea25ab.js"],import.meta.url),FeatureServiceSnappingSourceWorker:()=>h(()=>import("./FeatureServiceSnappingSourceWorker-549a91e2.js"),["./FeatureServiceSnappingSourceWorker-549a91e2.js","./JSONSupport-32b5ad86.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Evented-36093e88.js","./reactiveUtils-e6d6c898.js","./HandleOwner-f4554d8c.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./FeatureStore-b6e7eda2.js","./aaBoundingBox-dfb04110.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./featureConversionUtils-66a9b1ed.js","./jsonUtils-6d0a72e3.js","./Polyline-cf51ad23.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-3597a01f.js","./PooledRBush-15b28b04.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-5596e92b.js","./centroid-31e9f7c2.js","./QueryEngineResult-60e819c8.js","./preload-helper-41c905a7.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./request-f01affa1.js","./zscale-d428b1da.js","./json-48e3ea08.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngine-146c01b4.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./TileInfo-c1a6fc90.js","./Query-6df7497c.js","./TimeExtent-4bfae662.js","./Field-efd8d6fa.js","./fieldType-ec749512.js","./Clonable-95fa5d2d.js","./ElevationInfo-bc15f954.js","./lengthUtils-e2d3809d.js","./symbologySnappingCandidates-58695ef9.js","./LRUCache-805da42e.js","./asyncUtils-8de18dd2.js","./arcgisLayerUrl-1177870a.js","./persistableUrlUtils-ccf13db2.js","./pbfQueryUtils-e595cc71.js","./pbf-490f560a.js","./query-159ca0c6.js","./queryZScale-7c3cd57e.js","./byteSizeEstimations-f0cab514.js"],import.meta.url),GeoJSONSourceWorker:()=>h(()=>import("./GeoJSONSourceWorker-0d38a94a.js"),["./GeoJSONSourceWorker-0d38a94a.js","./request-f01affa1.js","./preload-helper-41c905a7.js","./Error-62cc7aff.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./promiseUtils-59dab60c.js","./asyncUtils-8de18dd2.js","./JSONSupport-32b5ad86.js","./ensureType-249b88cd.js","./nextTick-3ee5a785.js","./jsonUtils-6d0a72e3.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./featureConversionUtils-66a9b1ed.js","./aaBoundingBox-dfb04110.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-b6e7eda2.js","./Evented-36093e88.js","./BoundsStore-3597a01f.js","./PooledRBush-15b28b04.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-5596e92b.js","./centroid-31e9f7c2.js","./QueryEngineResult-60e819c8.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./zscale-d428b1da.js","./json-48e3ea08.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngine-146c01b4.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./reactiveUtils-e6d6c898.js","./geojson-036307ec.js","./clientSideDefaults-6c382415.js","./defaultsJSON-59981e75.js","./sourceUtils-f5f29e87.js","./fieldType-ec749512.js"],import.meta.url),LercWorker:()=>h(()=>import("./LercWorker-087daaa1.js"),["./LercWorker-087daaa1.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js"],import.meta.url),MemorySourceWorker:()=>h(()=>import("./MemorySourceWorker-5e768586.js"),["./MemorySourceWorker-5e768586.js","./Error-62cc7aff.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./jsonUtils-6d0a72e3.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./ensureType-249b88cd.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./featureConversionUtils-66a9b1ed.js","./aaBoundingBox-dfb04110.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./objectIdUtils-789e911a.js","./FeatureStore-b6e7eda2.js","./Evented-36093e88.js","./BoundsStore-3597a01f.js","./PooledRBush-15b28b04.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-5596e92b.js","./centroid-31e9f7c2.js","./QueryEngineResult-60e819c8.js","./preload-helper-41c905a7.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./request-f01affa1.js","./zscale-d428b1da.js","./json-48e3ea08.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngine-146c01b4.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./reactiveUtils-e6d6c898.js","./clientSideDefaults-6c382415.js","./defaultsJSON-59981e75.js","./sourceUtils-f5f29e87.js","./fieldType-ec749512.js"],import.meta.url),PBFDecoderWorker:()=>h(()=>import("./PBFDecoderWorker-48c7a8dd.js"),["./PBFDecoderWorker-48c7a8dd.js","./compilerUtils-2eb56463.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./JSONSupport-32b5ad86.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./zscale-d428b1da.js","./dehydratedFeatures-be6dfdbf.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-dfb04110.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./quantizationUtils-5accf704.js","./Polyline-cf51ad23.js","./typeUtils-05f9d41d.js","./Field-efd8d6fa.js","./enumeration-504d95a2.js","./fieldType-ec749512.js","./featureConversionUtils-66a9b1ed.js","./jsonUtils-6d0a72e3.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./pbfQueryUtils-e595cc71.js","./pbf-490f560a.js"],import.meta.url),Pipeline:()=>h(()=>import("./Pipeline-c0db1c24.js").then(o=>o.P),["./Pipeline-c0db1c24.js","./JSONSupport-32b5ad86.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./HandleOwner-f4554d8c.js","./reactiveUtils-e6d6c898.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./TileInfo-c1a6fc90.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./preload-helper-41c905a7.js","./featureConversionUtils-66a9b1ed.js","./aaBoundingBox-dfb04110.js","./jsonUtils-6d0a72e3.js","./Polyline-cf51ad23.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngine-146c01b4.js","./MemCache-a072224a.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./request-f01affa1.js","./QueryEngineResult-60e819c8.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./zscale-d428b1da.js","./json-48e3ea08.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./StreamFeatureManager-032b2140.js","./Evented-36093e88.js","./quickselect-56c5966e.js","./diffUtils-a2efee1b.js","./Collection-9e42cc30.js","./ArcadeDate-3d8ef842.js","./arcadeTimeUtils-ff4f0a96.js","./TimeReference-dbe22fa2.js","./Clonable-95fa5d2d.js","./centroid-31e9f7c2.js","./arcgisLayerUrl-1177870a.js","./persistableUrlUtils-ccf13db2.js","./ogcFeatureUtils-c583b7b8.js","./geojson-036307ec.js","./clientSideDefaults-6c382415.js","./defaultsJSON-59981e75.js","./fieldType-ec749512.js","./query-159ca0c6.js","./pbfQueryUtils-e595cc71.js","./pbf-490f560a.js","./queryZScale-7c3cd57e.js","./TimeExtent-4bfae662.js","./Query-6df7497c.js","./Field-efd8d6fa.js","./createConnection-bf576a38.js","./definitions-12364007.js","./enums-e09487cb.js","./TileInfoView-4462e6db.js","./TileKey-5f02dc79.js","./enums-fc527c7c.js","./number-b10bd8f5.js"],import.meta.url),PointCloudWorker:()=>h(()=>import("./PointCloudWorker-4c1147df.js"),["./PointCloudWorker-4c1147df.js","./typedArrayUtil-70e1d79e.js","./quat-99c4e099.js","./mat3f64-50f3b9f6.js","./quatf64-f8f1c132.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./quatf32-51a323b8.js","./vec3f32-01c06d8d.js","./projection-d42b91be.js","./preload-helper-41c905a7.js","./Error-62cc7aff.js","./string-7a2f1d87.js","./mathUtils-5b623c84.js","./promiseUtils-59dab60c.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./ensureType-249b88cd.js","./nextTick-3ee5a785.js","./Ellipsoid-89682c5e.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./Polyline-cf51ad23.js","./assets-640b4d04.js","./request-f01affa1.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./PointCloudWorkerUtil-212fccb8.js","./PointCloudUniqueValueRenderer-6cce9ee5.js","./enumeration-504d95a2.js","./LegendOptions-d1ee6f9f.js","./Color-5a385b27.js","./colorUtils-639f4d25.js","./I3SBinaryReader-c63d93b8.js","./VertexAttribute-15d1866a.js"],import.meta.url),RasterWorker:()=>h(()=>import("./RasterWorker-0d8c1935.js"),["./RasterWorker-0d8c1935.js","./geometry-f89ca072.js","./ensureType-249b88cd.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./Error-62cc7aff.js","./Extent-2ad2c9a9.js","./JSONSupport-32b5ad86.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Ellipsoid-89682c5e.js","./Polyline-cf51ad23.js","./typeUtils-05f9d41d.js","./projection-d42b91be.js","./preload-helper-41c905a7.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./request-f01affa1.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./vectorFieldUtils-b0aae2f9.js","./Color-5a385b27.js","./colorUtils-639f4d25.js","./colorUtils-7641d345.js","./dataUtils-fc7a03b6.js","./utils-44ff9342.js","./enumeration-504d95a2.js","./colorRamps-844ba070.js","./rasterProjectionHelper-957108f9.js"],import.meta.url),SceneLayerSnappingSourceWorker:()=>h(()=>import("./SceneLayerSnappingSourceWorker-46814e66.js"),["./SceneLayerSnappingSourceWorker-46814e66.js","./JSONSupport-32b5ad86.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./vec3-015ca254.js","./common-d0b63c2d.js","./lineSegment-8ffcb750.js","./mathUtils-5b623c84.js","./vec4-c7a19f0d.js","./sphere-092242fd.js","./mat4-4714ff8c.js","./vec4f64-6d0e93be.js","./byteSizeEstimations-f0cab514.js","./mat3f64-50f3b9f6.js","./mat4f64-abdda1bb.js","./quatf64-f8f1c132.js","./vec2f64-f35767d6.js","./QueryEngineResult-60e819c8.js","./preload-helper-41c905a7.js","./Polyline-cf51ad23.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./assets-640b4d04.js","./request-f01affa1.js","./aaBoundingRect-42f9721f.js","./zscale-d428b1da.js","./json-48e3ea08.js","./jsonUtils-6d0a72e3.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./featureConversionUtils-66a9b1ed.js","./aaBoundingBox-dfb04110.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./Octree-fac2eadb.js","./plane-fef3662c.js","./Util-c12e93ba.js","./edgeProcessing-9fe73f05.js","./deduplicate-3aef92f2.js","./Indices-7097baff.js","./InterleavedLayout-d75b8228.js","./BufferView-da65c548.js","./vec2-8acac370.js","./types-e1c0a5bf.js","./VertexAttribute-15d1866a.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),SceneLayerWorker:()=>h(()=>import("./SceneLayerWorker-273f0a07.js").then(o=>o.S),["./SceneLayerWorker-273f0a07.js","./typedArrayUtil-70e1d79e.js","./preload-helper-41c905a7.js","./assets-640b4d04.js","./Error-62cc7aff.js","./string-7a2f1d87.js","./request-f01affa1.js","./promiseUtils-59dab60c.js","./I3SNode-748304db.js","./sphere-092242fd.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./mat4-4714ff8c.js","./vec4f64-6d0e93be.js","./nextTick-3ee5a785.js","./byteSizeEstimations-f0cab514.js","./mat3f64-50f3b9f6.js","./mat4f64-abdda1bb.js","./quatf64-f8f1c132.js","./vec2f64-f35767d6.js"],import.meta.url),WFSSourceWorker:()=>h(()=>import("./WFSSourceWorker-f8534527.js"),["./WFSSourceWorker-f8534527.js","./asyncUtils-8de18dd2.js","./JSONSupport-32b5ad86.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./ensureType-249b88cd.js","./Error-62cc7aff.js","./nextTick-3ee5a785.js","./promiseUtils-59dab60c.js","./Extent-2ad2c9a9.js","./Ellipsoid-89682c5e.js","./featureConversionUtils-66a9b1ed.js","./aaBoundingBox-dfb04110.js","./aaBoundingRect-42f9721f.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./jsonUtils-6d0a72e3.js","./Polyline-cf51ad23.js","./OptimizedFeature-cb86a86f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-b6e7eda2.js","./Evented-36093e88.js","./BoundsStore-3597a01f.js","./PooledRBush-15b28b04.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-5596e92b.js","./centroid-31e9f7c2.js","./QueryEngineResult-60e819c8.js","./preload-helper-41c905a7.js","./quantizationUtils-5accf704.js","./ItemCache-47345b61.js","./MemCache-a072224a.js","./WhereClause-ec2695a9.js","./executionError-fb3f283a.js","./datetime-b6333958.js","./utils-eec406bb.js","./generateRendererUtils-9fa055c1.js","./enumeration-504d95a2.js","./projection-d42b91be.js","./SimpleObservable-a6d3d2d8.js","./mat4-4714ff8c.js","./assets-640b4d04.js","./request-f01affa1.js","./zscale-d428b1da.js","./json-48e3ea08.js","./normalizeUtils-11faac16.js","./normalizeUtilsCommon-f5194d67.js","./geometry-f89ca072.js","./typeUtils-05f9d41d.js","./fieldUtils-e397be4b.js","./arcadeOnDemand-5c3ab3f7.js","./QueryEngine-146c01b4.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-3347fdc5.js","./Scheduler-22864fbd.js","./reactiveUtils-e6d6c898.js","./geojson-036307ec.js","./sourceUtils-f5f29e87.js","./wfsUtils-36b379b5.js","./xmlUtils-444cb4c0.js","./Field-efd8d6fa.js","./fieldType-ec749512.js"],import.meta.url),WorkerTileHandler:()=>h(()=>import("./WorkerTileHandler-9342a5d9.js"),["./WorkerTileHandler-9342a5d9.js","./promiseUtils-59dab60c.js","./string-7a2f1d87.js","./typedArrayUtil-70e1d79e.js","./Error-62cc7aff.js","./enums-fb086c25.js","./TileClipper-ae6eca9e.js","./StyleRepository-831332d3.js","./enums-e09487cb.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js","./Color-5a385b27.js","./colorUtils-639f4d25.js","./mathUtils-5b623c84.js","./vec3-015ca254.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./ensureType-249b88cd.js","./colorUtils-7641d345.js","./definitions-12364007.js","./Rect-98da58d6.js","./config-f7904f35.js","./pbf-490f560a.js","./TurboLine-2717f2ca.js","./preload-helper-41c905a7.js","./assets-640b4d04.js","./request-f01affa1.js","./earcut-61f7b102.js","./BidiEngine-836b7ef6.js"],import.meta.url)},{CLOSE:y,ABORT:I,INVOKE:S,RESPONSE:d,OPEN_PORT:A,ON:G}=c,q=2;class X{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}push(e){e.type===c.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class u{static connect(e){const t=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const r=new u(t.port1,{channel:t,client:s},()=>null);return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=r),u.clients.set(r,s),t.port2}static loadWorker(e){const t=U[e];return t?t():Promise.resolve(null)}constructor(e,t,s){this._port=e,this._getNextJob=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new X(r=>this._onInvokeMessage(r)),this._client=t.client,this._onMessage=this._onMessage.bind(this),this._channel=t.channel,this._schedule=t.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:y}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,t,s){const r=s&&s.signal,n=s&&s.transferList;if(!this._port)return Promise.reject(new v("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:t}));const i=x();return new Promise((l,a)=>{if(j(r))return this._processWork(),void a(f());const p=W(r,()=>{const _=this._outJobs.get(i);_&&(this._outJobs.delete(i),this._processWork(),E(_.abortHandle),this._post({type:I,jobId:i}),a(f()))}),m={resolve:l,reject:a,abortHandle:p,debugInfo:e};this._outJobs.set(i,m),this._post({type:S,jobId:i,methodName:e,abortable:r!=null},t,n)})}on(e,t){const s=new MessageChannel;function r(n){t(n.data)}return this._port.postMessage({type:c.ON,eventType:e,port:s.port2},[s.port2]),s.port1.addEventListener("message",r),s.port1.start(),{remove(){s.port1.postMessage({type:c.CLOSE}),s.port1.close(),s.port1.removeEventListener("message",r)}}}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:A,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=q)return;const e=this._getNextJob();if(!e)return;const{methodName:t,data:s,invokeOptions:r,deferred:n}=e;this.invoke(t,s,r).then(i=>n.resolve(i)).catch(i=>n.reject(i))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{E(e.abortHandle),e.reject(f(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}_onMessage(e){B(this._schedule)?this._schedule(()=>this._processMessage(e)):this._processMessage(e)}_processMessage(e){const t=O(e);if(t)switch(t.type){case d:this._onResponseMessage(t);break;case S:this._invokeQueue.push(t);break;case I:this._onAbortMessage(t);break;case y:this._onCloseMessage();break;case A:this._onOpenPortMessage(t);break;case G:this._onOnMessage(t)}}_onAbortMessage(e){const t=this._inJobs,s=e.jobId,r=t.get(s);this._invokeQueue.push(e),r&&(r.controller&&r.controller.abort(),t.delete(s))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&u.clients.get(this)===e&&e.destroy(),u.clients.delete(this),e&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:t,jobId:s,data:r,abortable:n}=e,i=n?new AbortController:null,l=this._inJobs;let a,p=this._client,m=p[t];try{if(!m&&t&&t.includes(".")){const _=t.split(".");for(let g=0;g<_.length-1;g++)p=p[_[g]],m=p[_[g+1]]}if(typeof m!="function")throw new TypeError(`${t} is not a function`);a=m.call(p,r,{client:this,signal:i?i.signal:null})}catch(_){return void this._post({type:d,jobId:s,error:b(_)})}N(a)?(l.set(s,{controller:i,promise:a}),a.then(_=>{l.has(s)&&(l.delete(s),this._post({type:d,jobId:s},_))},_=>{l.has(s)&&(l.delete(s),C(_)||this._post({type:d,jobId:s,error:b(_||{message:`Error encountered at method ${t}`})}))})):this._post({type:d,jobId:s},a)}_onOpenPortMessage(e){new u(e.port,{client:this._client},()=>null)}_onOnMessage(e){const{port:t}=e,s=this._client.on(e.eventType,n=>{t.postMessage(n)}),r=D(e.port,"message",n=>{var i;((i=O(n))==null?void 0:i.type)===c.CLOSE&&(r.remove(),s.remove(),t.close())})}_onResponseMessage(e){const{jobId:t,error:s,data:r}=e,n=this._outJobs;if(!n.has(t))return;const i=n.get(t);n.delete(t),this._processWork(),E(i.abortHandle),s?i.reject(v.fromJSON(JSON.parse(s))):i.resolve(r)}_post(e,t,s){return L(this._port,e,t,s)}}u.kernelInfo={revision:R,version:H,buildDate:J},u.clients=new Map;class ne{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Q}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,t){return new Promise((s,r)=>{let n=!0;const i=l=>{$(t.signal),n&&(n=!1,l())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let l=0;l<e.length;++l){const a=e[l];N(a)?this._clientPromises[l]=a.then(p=>(this._clients[l]=new u(p,t,()=>this._ongoingJobsQueue.pop()??null),i(s),this._clients[l]),()=>(i(r),null)):(this._clients[l]=new u(a,t,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[l]=Promise.resolve(this._clients[l]),i(s))}})}broadcast(e,t,s){const r=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const i=this._clientPromises[n];r[n]=i.then(l=>l==null?void 0:l.invoke(e,t,s))}return r}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.deferred.reject(f(`Worker closing, aborting job calling '${e.methodName}'`));for(const t of this._clientPromises)t.then(s=>s==null?void 0:s.close());this._clients.length=0,this._clientPromises.length=0}invoke(e,t,s){let r;Array.isArray(s)?(T.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),r={transferList:s}):r=s;const n=V();this._ongoingJobsQueue.push({methodName:e,data:t,invokeOptions:r,deferred:n});for(let i=0;i<this._clientPromises.length;i++){const l=this._clients[i];l?l.jobAdded():this._clientPromises[i].then(a=>a==null?void 0:a.jobAdded())}return n.promise}on(e,t){return Promise.all(this._clientPromises).then(()=>w(this._clients.map(s=>s.on(e,t))))}openPorts(){return new Promise(e=>{const t=new Array(this._clientPromises.length);let s=t.length;for(let r=0;r<this._clientPromises.length;++r)this._clientPromises[r].then(n=>{n&&(t[r]=n.openPort()),--s==0&&e(t)})})}get test(){return{numClients:this._clients.length}}}export{Q as e,O as f,ne as h,L as o,x as r,b as s,c as t,u as w};
