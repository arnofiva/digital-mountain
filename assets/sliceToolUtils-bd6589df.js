import"./geometry-bad16232.js";import{e as V,y as G,s as It,a as Qt,l as tr}from"./cast-8b575ab3.js";import{i as rr}from"./Clonable-2b8b60cc.js";import{s as At}from"./Cyclical-34b2a5e3.js";import{O as ir,e as er,r as q,t as U}from"./typedArrayUtil-ce39e5f4.js";import{a as Ct}from"./ArrayPool-5813d861.js";import{g as z}from"./persistable-63f0629a.js";import{w as sr}from"./Extent-680ef92a.js";import{h as or}from"./string-7a324480.js";import{s as nr}from"./Error-685fdf30.js";import{m as ot,b as ar}from"./mathUtils-5b623c84.js";import{p as ft}from"./screenUtils-410d12c0.js";import{R as Ot,f as Dt,c as X,l as jt,r as vt,i as Rt,A as Nt,x as dr}from"./mat4-4714ff8c.js";import{e as ht}from"./mat4f64-abdda1bb.js";import{Q as Pt}from"./quat-99c4e099.js";import{r as I,a as N,s as P,o as nt,u as m,g as p,e as O,n as at,z as L,P as F,_ as C,t as cr,v as lr}from"./vec3-015ca254.js";import{z as ur}from"./projection-582e07d8.js";import{d as gr,c as d,e as Y,i as pr,o as Lt,n as St}from"./sphere-8ab93b42.js";import{_ as hr,$ as mr,R as fr,aX as ut,bc as zt,aY as B,aZ as v,bb as tt,aQ as br,bG as yt,bH as _r,bF as $r,bI as Or,bJ as Tr,G as qt,bC as Bt,bK as bt,bE as Er,bL as wr}from"./index-334863ed.js";import{_ as Xt,O as Yt}from"./plane-e5e66c24.js";import{e as Z,r as x}from"./vec4f64-6d0e93be.js";import{n as Ir,g as Ar,b as Cr}from"./LineVisualElement-b2465764.js";import{V as vr,i as Zt,e as w,x as Rr,U as Nr}from"./manipulatorUtils-ea52a52a.js";import{a as Mt}from"./vec4-c7a19f0d.js";import{E as Pr,g as _}from"./VisualVariablePassParameters-8cb0a75a.js";import{h as Lr}from"./Matrix3PassUniform-0b3b1bba.js";import{t as Sr}from"./ShaderTechniqueConfiguration-ee770726.js";import{B as yr,E as Mr,d as Vr}from"./objectResourceUtils-8909e8c3.js";import{_ as Ur}from"./preload-helper-41c905a7.js";import{o as xr,a as Vt,n as Wr}from"./ShaderBuilder-7bfc11d2.js";import{t as kr,e as Hr,o as Gr,W as Fr,l as Dr,_ as jr}from"./EvaluateSceneLighting.glsl-5da94bb7.js";import{v as zr}from"./View.glsl-03db830e.js";import{e as Ut}from"./Float4PassUniform-7f3c3ce8.js";import{o as qr}from"./FloatPassUniform-e3702139.js";import{O as xt}from"./VertexAttribute-15d1866a.js";import{R as rt,I as Br}from"./enums-fc527c7c.js";import{n as it}from"./basicInterfaces-7449a8bf.js";let T=class extends rr(tr){constructor(r){super(r),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(r){return this.heading===r.heading&&this.tilt===r.tilt&&ir(this.position,r.position)&&this.width===r.width&&this.height===r.height}};V([G({readOnly:!0,json:{read:!1,write:!0}})],T.prototype,"type",void 0),V([G({type:sr}),z()],T.prototype,"position",void 0),V([G({type:Number,nonNullable:!0,range:{min:0,max:360}}),z(),It(t=>At.normalize(Ct(t),0,!0))],T.prototype,"heading",void 0),V([G({type:Number,nonNullable:!0,range:{min:0,max:360}}),z(),It(t=>At.normalize(Ct(t),0,!0))],T.prototype,"tilt",void 0),V([G({type:Number,nonNullable:!0}),z()],T.prototype,"width",void 0),V([G({type:Number,nonNullable:!0}),z()],T.prototype,"height",void 0),T=V([Qt("esri.analysis.SlicePlane")],T);const Xr=T,fe=or("mac")?"Meta":"Control",be="Shift",Yr=2,Zr=1.15,Jr=1.15,_e=2500,$e=.02,Kr=Math.cos(ot(45)),Wt=Math.cos(ot(5)),Oe=.95,Te=.3,Qr=.7,J=I(1,.5,0),Ee=2,ti=1,ri=Z([...J,Qr]),ii=[0,0,0,.04],ei=Z([...J,.5]),si=x(1,1,1,1),oi=x(1,.8,.6,1),ni=x(1,.93,.86,1),ai=Z([...J,1]),di=Z([...J,1]),ci=3,Jt=11,_t=22.5,st=40,kt=48,li=2.25,ui=Z([...J,1]),gi=4,Ht=1,pi=.3,hi=6,mi=4,Gt=1600,fi=.4;function bi(t){const r=new xr;r.extensions.add("GL_OES_standard_derivatives");const{vertex:i,fragment:s,attributes:o,varyings:n}=r;return zr(i,t),o.add(xt.POSITION,"vec3"),o.add(xt.UV0,"vec2"),n.add("vUV","vec2"),i.code.add(Vt`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add([new Ut("backgroundColor",e=>e.backgroundColor),new Ut("gridColor",e=>e.gridColor),new qr("gridWidth",e=>e.gridWidth)]),s.code.add(Vt`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),r}const _i=Object.freeze(Object.defineProperty({__proto__:null,build:bi},Symbol.toStringTag,{value:"Module"}));let $i=class extends Wr{constructor(){super(...arguments),this.backgroundColor=x(1,0,0,.5),this.gridColor=x(0,1,0,.5),this.gridWidth=4}};class gt extends Hr{initializeProgram(r){return new Gr(r.rctx,gt.shader.get().build(this.configuration),Pr)}initializePipeline(){return Fr({blending:Dr(rt.ONE,rt.ONE,rt.ONE_MINUS_SRC_ALPHA,rt.ONE_MINUS_SRC_ALPHA),depthTest:{func:Br.LESS},colorWrite:jr})}}gt.shader=new kr(_i,()=>Ur(()=>import("./SlicePlaneMaterial.glsl-8ca3a5a6.js"),["./SlicePlaneMaterial.glsl-8ca3a5a6.js","./View.glsl-03db830e.js","./mat4-4714ff8c.js","./vec3-015ca254.js","./common-d0b63c2d.js","./mat4f32-60a2394b.js","./ShaderBuilder-7bfc11d2.js","./typedArrayUtil-ce39e5f4.js","./Error-685fdf30.js","./string-7a324480.js","./VertexAttribute-15d1866a.js","./geometry-bad16232.js","./ArrayPool-5813d861.js","./Extent-680ef92a.js","./cast-8b575ab3.js","./nextTick-3ee5a785.js","./promiseUtils-e37fe75d.js","./Ellipsoid-89682c5e.js","./Polyline-889037e7.js","./typeUtils-700e0da4.js","./Clonable-2b8b60cc.js","./Cyclical-34b2a5e3.js","./mathUtils-5b623c84.js","./vec4-c7a19f0d.js","./persistable-63f0629a.js","./preload-helper-41c905a7.js","./multiOriginJSONSupportUtils-c978f4c3.js","./request-fc61835a.js","./uuid-73213768.js","./resourceExtension-a93bca74.js","./persistableUrlUtils-1c5d7615.js","./screenUtils-410d12c0.js","./mat4f64-abdda1bb.js","./quat-99c4e099.js","./mat3f64-50f3b9f6.js","./quatf64-f8f1c132.js","./projection-582e07d8.js","./SimpleObservable-6f002ab0.js","./assets-5052bbaa.js","./aaBoundingRect-41e05474.js","./zscale-def794ea.js","./sphere-8ab93b42.js","./vec4f64-6d0e93be.js","./byteSizeEstimations-f0cab514.js","./vec2f64-f35767d6.js","./index-334863ed.js","./IdentityManager-13ed5348.js","./Evented-d959ede6.js","./reactiveUtils-042dd05a.js","./intl-b84fb3c9.js","./number-134e9f14.js","./locale-30120714.js","./messages-8a541332.js","./Promise-e757e514.js","./dom-2ec1e33c.js","./Graphic-96c42a4d.js","./PopupTemplate-8ac0cb61.js","./Collection-47946fa8.js","./fieldUtils-1ecec444.js","./arcadeOnDemand-a1bf65ec.js","./enumeration-4ec8d3f9.js","./Identifiable-96150ecf.js","./symbols-0f3de684.js","./CIMSymbol-cdddfd9c.js","./Color-ad49dc79.js","./colorUtils-639f4d25.js","./opacityUtils-6b5cbdc2.js","./symbolLayerUtils3D-51cc6d75.js","./aaBoundingBox-04c58f5a.js","./Symbol3DAnchorPosition2D-142c1e90.js","./collectionUtils-25147e5f.js","./Portal-7ecdc9f0.js","./Loadable-695031ac.js","./PortalGroup-ea788274.js","./PortalUser-a1aa49cd.js","./jsonUtils-03437bcd.js","./Basemap-f5ca570d.js","./deprecate-9828d7d2.js","./loadAll-8401c5ec.js","./asyncUtils-623987a8.js","./PortalItem-6549afda.js","./writeUtils-ff257e5e.js","./layerUtils-0c01cb0c.js","./compilerUtils-175b9e40.js","./CollectionFlattener-9bc75576.js","./TablesMixin-b6031ef9.js","./Layer-b29c44e3.js","./MultiOriginJSONSupport-a1d33be9.js","./originUtils-1469eeaf.js","./HeightModelInfo-42ae0f61.js","./arcgisLayerUrl-81a33ec5.js","./ViewingMode-5d7d590b.js","./saveUtils-bf4b189a.js","./resourceUtils-e6e10558.js","./fieldType-232282e5.js","./OperationalLayer-c3a14c54.js","./TimeExtent-d116f9c4.js","./ElevationInfo-ad190ee6.js","./lengthUtils-1d09729e.js","./plane-e5e66c24.js","./mat3-4fd89d48.js","./Octree-d990d188.js","./Util-c12e93ba.js","./scaleUtils-87bb90d3.js","./lineSegment-b352e49e.js","./objectResourceUtils-8909e8c3.js","./devEnvironmentUtils-5002a058.js","./BufferView-da65c548.js","./vec2-8acac370.js","./vec33-8529ce65.js","./DefaultMaterial_COLOR_GAMMA-87d1f8e6.js","./types-e1c0a5bf.js","./enums-fc527c7c.js","./Version-419f71e1.js","./resourceUtils-527631ac.js","./basicInterfaces-7449a8bf.js","./Indices-37e06e9a.js","./DefaultMaterial.glsl-7d7dc23e.js","./ForwardLinearDepth.glsl-a0929473.js","./Matrix3PassUniform-0b3b1bba.js","./vec3f32-01c06d8d.js","./Texture2DPassUniform-70e1e126.js","./MixExternalColor.glsl-99b269fe.js","./ShaderTechniqueConfiguration-ee770726.js","./symbolColorUtils-834d5fca.js","./PhysicallyBasedRendering.glsl-32dfb9c7.js","./FloatPassUniform-e3702139.js","./Float4PassUniform-7f3c3ce8.js","./RgbaFloatEncoding.glsl-4a25e2a7.js","./Texture2DDrawUniform-02720a73.js","./PiUtils.glsl-5ee49495.js","./VisualVariablePassParameters-8cb0a75a.js","./VertexElementDescriptor-2925c6af.js","./Texture-bf6b5582.js","./context-util-7ede29e5.js","./Slice.glsl-7975394d.js","./Transform.glsl-7294c426.js","./ObjectAndLayerIdColor.glsl-a64028da.js","./OutputDepth.glsl-f581dcdd.js","./OutputHighlight.glsl-08aacdf4.js","./VisualVariables.glsl-9e988d16.js","./DiscardOrAdjustAlphaBlend.glsl-f19054e7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-a6b20292.js","./VertexColor.glsl-79a8c465.js","./VerticalOffset.glsl-5354e013.js","./Normals.glsl-0f400ece.js","./EvaluateSceneLighting.glsl-5da94bb7.js","./SSAOBlur.glsl-7265df26.js","./ScreenSpacePass.glsl-fee70090.js","./ReadLinearDepth.glsl-53a01bc1.js","./SSAO.glsl-c9cc39dd.js","./MultipassTerrainTest.glsl-43f42334.js","./vec2f32-eaf29605.js","./Texture-87febf19.js","./TextureOnly.glsl-548e665f.js","./Attribute-f72d3f37.js","./InterleavedLayout-d75b8228.js","./DefaultTechniqueConfiguration-5fedee5c.js","./RealisticTree.glsl-1e8f0ea9.js","./Scheduler-3113abcd.js","./GraphicsLayer-70f87af0.js","./HandleOwner-f773ce72.js","./BlendLayer-291a2b49.js","./ScaleRangeLayer-7ff6c0d3.js","./workers-c3882da6.js","./Connection-6bd43370.js","./spatialReferenceEllipsoidUtils-23733e37.js","./AttachmentInfo-6f2ba68c.js","./AttachmentQuery-061e93ef.js","./LegendOptions-de492976.js","./DimensionalDefinition-4b26df38.js","./UniqueValueRenderer-3904f4cc.js","./diffUtils-0c65d604.js","./colorRamps-ddfecb23.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-a1979e31.js","./jsonUtils-e877a23b.js","./styleUtils-305d8f69.js","./vectorFieldUtils-3e325848.js","./colorUtils-7641d345.js","./normalizeUtils-6bee55d6.js","./normalizeUtilsCommon-17a95432.js","./ItemCache-c0904c4f.js","./MemCache-1d0e264b.js","./cimSymbolUtils-bff8b59b.js","./utils-3d986af0.js","./jsonUtils-b2e5d321.js","./DictionaryLoader-1438695d.js","./LRUCache-16cff7d8.js","./heatmapUtils-bc76f08e.js","./Query-65d38c02.js","./Field-1bc3a16a.js","./executeQueryJSON-04f85be1.js","./query-b200d7cb.js","./pbfQueryUtils-f001828a.js","./pbf-68e00ce0.js","./OptimizedFeature-7f37a325.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-bd6bba60.js","./FeatureSet-cb704b51.js","./featureConversionUtils-c227ec85.js","./RelationshipQuery-0abdb3e2.js","./TopFeaturesQuery-3a519c5e.js","./FeatureLayer-f2f6536e.js","./serviceCapabilitiesUtils-6f645c61.js","./FeatureLayerBase-b19f7ee7.js","./TimeReference-aeda2bb8.js","./datetime-b6333958.js","./editsZScale-eefb35e6.js","./APIKeyMixin-d7cb7220.js","./ArcGISService-7ce81abb.js","./CustomParametersMixin-0dbce8f2.js","./EditBusLayer-faff46ba.js","./FeatureReductionLayer-55e6b2c4.js","./labelingInfo-8462538e.js","./labelUtils-61dff46d.js","./defaultsJSON-59981e75.js","./OrderedLayer-f840e564.js","./PortalLayer-7f6f61d4.js","./portalItemUtils-ba37e370.js","./RefreshableLayer-51d28698.js","./TemporalLayer-12ea8921.js","./FeatureTemplate-26b6ba5d.js","./FeatureType-474514d1.js","./fieldProperties-66b12497.js","./FieldsIndex-967913ce.js","./versionUtils-f77d2452.js","./styleUtils-4d62e921.js","./popupUtils-7d1e2de5.js","./callExpressionWithFeature-6f3761f2.js","./quantizationUtils-dc028b68.js","./webStyleSymbolUtils-0f876db3.js","./ElevationSamplerData-b8eeacdf.js","./TileInfo-f339e6a5.js","./WaterSurface.glsl-55a88d78.js","./NormalUtils.glsl-f259fe4a.js","./HUD.glsl-79bd614f.js","./edgeProcessing-fa6d4038.js","./deduplicate-dffc7dea.js","./MeshComponent-f5ec9479.js","./earcut-61f7b102.js","./projection-c67d3c7f.js","./HUDMaterial.glsl-caa3e151.js","./sdfPrimitives-86e63320.js","./floatRGBA-11065dbc.js","./dehydratedFeatures-55779981.js","./labelFormatUtils-695eab3b.js","./orientedBoundingBox-8bbf4141.js","./quatf32-51a323b8.js","./LineCallout.glsl-ede36b7c.js","./QueryEngineResult-c580d29f.js","./WhereClause-cbd158ef.js","./executionError-fb3f283a.js","./utils-f1e38d04.js","./generateRendererUtils-65ba2788.js","./json-48e3ea08.js","./MarkerSizing.glsl-0f21463c.js","./RibbonLine.glsl-376e988d.js","./LineStipple.glsl-dfd34f08.js","./LineMarker.glsl-b68d2081.js","./NativeLine.glsl-38506d53.js","./Path.glsl-5da6ce18.js","./ColorMaterial.glsl-d42d7e44.js","./Pattern.glsl-cc643bcf.js","./LercDecoder-e072a355.js","./enums-fb086c25.js","./config-f7904f35.js","./TileKey-ae8a9188.js","./workerHelper-7b69330e.js","./capabilities-8176ed28.js","./geometryEngine-68f880a9.js","./geometryEngineBase-e1a33b0a.js","./hydrated-61d2b3c5.js","./floating-ui-8c8de742.js","./StreamLayer-b816a6d3.js","./SceneFilter-8312e3bf.js","./elevationInfoUtils-ab005f9a.js","./DimensionAnalysis-0ac2f8cd.js","./Analysis-cc5bd6fb.js","./ExportImageParameters-c93de02f.js","./sublayerUtils-7a7b4353.js","./index-2f6aec2e.css","./LineVisualElement-b2465764.js","./manipulatorUtils-ea52a52a.js","./ImageMaterial-29c669c5.js","./ImageMaterial.glsl-cead626d.js","./ShadedColorMaterial.glsl-a97ba27a.js"],import.meta.url));class Oi extends hr{constructor(r){super(r,new Ei),this._configuration=new Sr}createBufferWriter(){return new yr(mr)}requiresSlot(r,i){return i===Lr.Color&&r===Mr.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(r){return new Ti(r)}getConfiguration(){return this._configuration}}class Ti extends Vr{constructor(r){super(r),this.ensureTechnique(gt,null)}beginSlot(){return er(this.technique)}}class Ei extends $i{constructor(){super(...arguments),this.renderOccluded=_.Occlude}}class wi extends Ir{constructor(r){super(r),this._material=null,this._renderOccluded=_.OccludeAndTransparent,this._gridWidth=1,this._gridColor=x(1,0,0,1),this._backgroundColor=x(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){Mt(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){Mt(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new Oi(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(r){q(this._material)&&r(this._material)}createGeometries(r){if(q(this._material)){const i=fr(this._material);r.addGeometry(i)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){q(this._material)&&this._material.setParameters(this._materialParameters)}}function Ie(t,r,i,s,o,n,e,a){return Ii(r,e.worldUpAtPosition(t,d.get()),o,n,a.basis1,a.basis2),p(a.basis1,a.basis1,i),p(a.basis2,a.basis2,s),N(a.origin,t),Yt(a.basis2,a.basis1,a.origin,a.plane),a}function Ii(t,r,i,s,o,n){const e=F(t,r),a=d.get(),c=d.get();switch(s===R.HORIZONTAL_OR_VERTICAL?Math.abs(e)>Kr?R.HORIZONTAL:R.VERTICAL:s){case R.VERTICAL:{const l=Math.abs(e)<=Wt?t:i.viewUp;C(a,l,r),N(c,r);break}case R.HORIZONTAL:C(a,i.viewUp,r),C(c,r,a);break;case R.TILTED:{const l=Math.abs(e)<=Wt?r:i.viewUp;C(a,l,t),C(c,t,a);break}}const g=C(d.get(),a,c);F(g,i.viewForward)>0&&p(c,c,-1),L(o,a),L(n,c)}function Ai(t,r,i){const s=r.worldUpAtPosition(t.origin,d.get()),o=t.basis1,n=wt(t,s),e=Math.round(n/D)*D;return bt(t,e-n,o,i)}function Ae(t,r,i,s,o,n){const e=N(d.get(),o.origin);m(e,e,p(d.get(),o.basis1,t.direction[0]<0?1:-1)),m(e,e,p(d.get(),o.basis2,t.direction[1]<0?1:-1));const a=P(o.basis1),c=P(o.basis2),g=O(d.get(),i,e),l=O(d.get(),r,e);let u=0,h=0;if(Et(t)){const K=$t(o),y=$t(n);u=a-.5*t.direction[0]*F(o.basis1,l)/a,h=c-.5*t.direction[1]*F(o.basis2,l)/c;const k=y/K;u*=k,h*=k}const $=u+.5*t.direction[0]*F(o.basis1,g)/a,b=h+.5*t.direction[1]*F(o.basis2,g)/c,W=p(d.get(),o.basis1,$/a),S=p(d.get(),o.basis2,b/c);($<=0||Ft(n.origin,W,s)<=Gt)&&N(W,n.basis1),(b<=0||Ft(n.origin,S,s)<=Gt)&&N(S,n.basis2);const f=N(d.get(),e);return m(f,f,p(d.get(),W,t.direction[0]<0?-1:1)),m(f,f,p(d.get(),S,t.direction[1]<0?-1:1)),$r(f,W,S,n)}function Ce(t,r){return fi*Math.min(r.width,r.height)*r.computeRenderPixelSizeAt(t)}function ve(t,r,i,s){const o=C(d.get(),r,i);return C(o,o,r),Xt(t,o,s)}function Re(t,r){return vr(t.basis1,t.basis2,t.origin,r)}function Ne(t,r,i,s){const o=r.worldUpAtPosition(t.origin,d.get()),n=d.get();switch(i){case dt.HEADING:N(n,o);break;case dt.TILT:N(n,t.basis1)}return Xt(t.origin,n,s)}function Pe(t,r,i,s){const o=Tt(i,A.NEGATIVE_X),n=Y.get();dr(n,r,o.edge*Math.PI/2);const e=L(d.get(),o.basis);let a=p(d.get(),e,o.direction*s.computeScreenPixelSizeAt(o.position)*st);m(a,a,o.position);const c=s.projectToRenderScreen(a,ft(d.get())),g=Ci(s,c);Or(s,c,et),L(et.direction,et.direction);const l=d.get();!g&&Tr(i,et,l)&&(a=l),n[12]=0,n[13]=0,n[14]=0,t.modelTransform=n,t.renderLocation=cr(a),g?t.state|=ct:t.state&=~ct}function Ci(t,r){const[i,s,o,n]=t.viewport,e=Math.min(o,n)/16;let a=!0;return r[0]<i+e?(r[0]=i+e,a=!1):r[0]>i+o-e&&(r[0]=i+o-e,a=!1),r[1]<s+e?(r[1]=s+e,a=!1):r[1]>s+n-e&&(r[1]=s+n-e,a=!1),a}function Le(t,r,i,s){const o=P(s.basis1),n=P(s.basis2),e=Kt(s),a=$t(s),c=nt(d.get(),0,0,0);m(c,p(d.get(),s.basis1,r.direction[0]),p(d.get(),s.basis2,r.direction[1])),m(c,s.origin,c);let g=0,l=1;if(Et(r))r.direction[0]===1&&r.direction[1]===-1?g=D:r.direction[0]===1&&r.direction[1]===1?g=Math.PI:r.direction[0]===-1&&r.direction[1]===1&&(g=3*Math.PI/2),l=a;else{const h=r.direction[0]!==0?1:2;g=h===1?D:0,l=(h===1?n:o)-e}const u=Ot(Y.get(),g);Dt(u,u,nt(d.get(),l,l,l)),X(u,i,u),u[12]=0,u[13]=0,u[14]=0,t.modelTransform=u,t.renderLocation=c}function Se(t,r,i,s){const o=s.worldUpAtPosition(i.origin,d.get()),n=Tt(i,A.POSITIVE_X),e=Ot(Y.get(),n.edge*Math.PI/2);jt(e,e,-wt(i,o)),X(e,r,e),e[12]=0,e[13]=0,e[14]=0,t.modelTransform=e,t.renderLocation=n.position}function ye(t,r,i){const s=Tt(i,A.POSITIVE_Y),o=Ot(Y.get(),s.edge*Math.PI/2);jt(o,o,D),X(o,r,o),o[12]=0,o[13]=0,o[14]=0,t.modelTransform=o,t.renderLocation=s.position}var A;function Tt(t,r){switch(r){case A.POSITIVE_X:return{basis:t.basis1,direction:1,position:m(d.get(),t.origin,t.basis1),edge:r};case A.POSITIVE_Y:return{basis:t.basis2,direction:1,position:m(d.get(),t.origin,t.basis2),edge:r};case A.NEGATIVE_X:return{basis:t.basis1,direction:-1,position:O(d.get(),t.origin,t.basis1),edge:r};case A.NEGATIVE_Y:return{basis:t.basis2,direction:-1,position:O(d.get(),t.origin,t.basis2),edge:r}}}function Ft(t,r,i){const s=i.projectToRenderScreen(m(d.get(),t,r),ft(d.get())),o=i.projectToRenderScreen(O(d.get(),t,r),ft(d.get()));return lr(O(s,s,o))}function Kt(t){const r=P(t.basis1),i=P(t.basis2);return pi*Math.min(r,i)}function $t(t){return Kt(t)}function Et(t){return t.direction[0]!==0&&t.direction[1]!==0}function Me(t,r=lt.CENTER_ON_ARROW){const i=r===lt.CENTER_ON_CALLOUT?st:0,s=[I(i,0,-kt/2),I(i,0,kt/2)],o=Ni(s,!0),n=(u,h)=>vi(s,u,h),e=n(0,!1),a=n(li,!0),c=new zt({color:ai,renderOccluded:_.OccludeAndTransparent}),g=B(c,[[i,0,0],[i-st,0,0]]),l=B(c,[[i,0,0],[i-st,0,0]]);return new Zt({view:t,renderObjects:[...e.normal.map(u=>new w(u,v.Unfocused|E)),...a.normal.map(u=>new w(u,v.Unfocused|E)),new w(g,v.Unfocused|E|ct),...e.focused.map(u=>new w(u,v.Focused|E)),...a.focused.map(u=>new w(u,v.Focused|E)),new w(l,v.Focused|E|ct)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[o]},collisionPriority:1,radius:Jt,state:E})}function Ve(t,r){const i=Nr(t,{customStateMask:E,texture:r});return i.state=E,i}function Ue(t){const r=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ar({view:t,attached:!1,color:ri,width:ti,writeDepthEnabled:!1,renderOccluded:_.OccludeAndTransparent,geometry:[r]})}function xe(t){return new wi({view:t,attached:!1,backgroundColor:[...ii],gridColor:ei,gridWidth:4,renderOccluded:_.OccludeAndTransparent})}function We(t,r){const i=Et(r),s=i?[I(1,0,0),I(0,0,0),I(0,1,0)]:[I(1,0,0),I(-1,0,0)],o=ui,n=$=>new br({color:o,width:$,renderOccluded:_.OccludeAndTransparent}),e=()=>new zt({color:o,renderOccluded:_.OccludeAndTransparent}),a=i?gi:Ht,c=a*Yr,g=Ht,l=$=>$>1?n($):e(),u=[new w(B(l(a),s),v.Unfocused|mt),new w(B(l(c),s),v.Focused|mt),new w(B(l(g),s),Li)],h=new Zt({view:t,renderObjects:u,collisionType:{type:"line",paths:[s]},radius:i?hi:mi,...Rr});return h.state=mt,h}function vi(t,r,i){const s=new tt({color:si,cullFace:it.Back,renderOccluded:_.Opaque}),o=new tt({color:oi,cullFace:it.Back,renderOccluded:_.Opaque}),n=new tt({color:ni,cullFace:it.Back,renderOccluded:_.Opaque}),e=new tt({color:di,transparent:!0,writeDepth:!1,cullFace:it.Front,renderOccluded:_.Transparent}),a=c=>{t=t.slice(0);const g=O(d.get(),t[0],t[1]);L(g,g);const l=O(d.get(),t[t.length-1],t[t.length-2]);if(L(l,l),r>0){const j=p(at(),l,-r);t[t.length-1]=m(j,j,t[t.length-1]);const H=p(at(),g,-r);t[0]=m(H,H,t[0])}const u=c?Jr:1,h=_t*u,$=Jt*u,b=vt(Y.get());if(r>0){const j=h/4,H=nt(d.get(),0,j,0),Q=1+r/j;Rt(b,b,H),Dt(b,b,nt(d.get(),Q,Q,Q)),Rt(b,b,p(H,H,-1/Q))}const W=vt(ht()),S=I(0,1,0),f=Nt(ht(),Pt(Lt.get(),S,l));f[12]=t[t.length-1][0],f[13]=t[t.length-1][1],f[14]=t[t.length-1][2],X(f,f,b);const K=Ri(ci*(c?Zr:1)+r,t,i?e:n);K.transformation=W;const y=[K],k=yt(i?e:s,h,$,24,!1,!1,!0);k.transformation=f,y.push(k);const pt=yt(i?e:o,h,$,24,!1,!0,!1);pt.transformation=f,y.push(pt);const M=Nt(ht(),Pt(Lt.get(),S,g));return M[12]=t[0][0],M[13]=t[0][1],M[14]=t[0][2],X(M,M,b),y.push(k.instantiate({transformation:M})),y.push(pt.instantiate({transformation:M})),y};return{normal:a(!1),focused:a(!0)}}function Ri(t,r,i){const s=[];for(let n=0;n<12;n++){const e=n/12*2*Math.PI;s.push([Math.cos(e)*t,Math.sin(e)*t])}return _r(i,s,r,[],[],!1)}function Ni(t,r){const i=O(at(),t[t.length-1],t[t.length-2]);if(L(i,i),p(i,i,_t),m(i,i,t[t.length-1]),r){const s=O(at(),t[0],t[1]);return L(s,s),p(s,s,_t),m(s,s,t[0]),[s,...t,i]}return[...t,i]}function ke(t,r,i,s=new Xr){if(U(t))return null;const{renderCoordsHelper:o}=r,n=o.fromRenderCoords(t.origin,r.spatialReference);if(U(n))return null;const e=ur(n,i);if(U(e))return null;s.position=e;const a=2*P(t.basis1),c=2*P(t.basis2),g=qt.renderUnitScaleFactor(r.spatialReference,i);s.width=a*g,s.height=c*g;const l=o.worldUpAtPosition(t.origin,d.get());return s.tilt=ar(wt(t,l)),s.heading=o.headingAtPosition(t.origin,t.basis1)-90,s}function wt(t,r){return pr(r,t.basis2,t.basis1)+D}function Pi(t,r,i,s,o,n,e=Bt()){return n.toRenderCoords(t,e.origin)?(n.worldBasisAtPosition(e.origin,St.X,e.basis1),n.worldBasisAtPosition(e.origin,St.Y,e.basis2),Yt(e.basis2,e.basis1,e.origin,e.plane),bt(e,-ot(r),Er(e),e),bt(e,ot(i),e.basis1,e),p(e.basis1,e.basis1,s/2),p(e.basis2,e.basis2,o/2),wr(e),e):(nr.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${t.spatialReference.wkid} is not supported`),null)}function He(t,r){if(U(t)||U(t.position))return null;const i=Cr(t.position,r.spatialReference,r.elevationProvider);if(U(i))return null;const s=qt.renderUnitScaleFactor(t.position.spatialReference,r.spatialReference),o=t.width*s,n=t.height*s;return{position:i,heading:t.heading,tilt:t.tilt,renderWidth:o,renderHeight:n}}function Ge(t,r,i,s=Bt()){if(U(t))return null;const o=Pi(t.position,t.heading,t.tilt,t.renderWidth,t.renderHeight,r.renderCoordsHelper,s);return!i.tiltEnabled&&q(o)&&Ai(o,r.renderCoordsHelper,o),o}(function(t){t[t.POSITIVE_X=0]="POSITIVE_X",t[t.POSITIVE_Y=1]="POSITIVE_Y",t[t.NEGATIVE_X=2]="NEGATIVE_X",t[t.NEGATIVE_Y=3]="NEGATIVE_Y"})(A||(A={}));const E=ut.Custom1;var dt,R;(function(t){t[t.HEADING=1]="HEADING",t[t.TILT=2]="TILT"})(dt||(dt={})),function(t){t[t.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.TILTED=3]="TILTED"}(R||(R={}));const ct=ut.Custom2,et=gr(),D=Math.PI/2,mt=ut.Custom1,Li=ut.Custom2;var lt;function Fe(t){const r=t.type==="building-scene-3d"?t:null;return q(r)}(function(t){t[t.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",t[t.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(lt||(lt={}));export{Re as B,ei as C,E,Ie as G,dt as I,Le as J,Se as K,Te as M,lt as N,Ge as O,Fe as P,ye as Q,R,He as T,ve as W,Ae as Y,Ce as Z,mt as _,Ve as a,Ee as b,Ue as c,fe as d,_e as e,ri as f,ke as g,Xr as h,$e as i,ct as j,Li as k,xe as l,be as m,Oe as n,$t as o,Ne as q,Et as r,Me as s,bi as t,We as u,ti as v,ii as x,Pe as z};
