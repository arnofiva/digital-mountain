import{U as f}from"./request-f01affa1.js";import{a as u}from"./Error-62cc7aff.js";import{r as g}from"./typedArrayUtil-70e1d79e.js";async function P(n,r,o,t,a,i){let s=null;if(g(o)){const e=`${n}/nodepages/`,p=e+Math.floor(o.rootIndex/o.nodesPerPage);try{return{type:"page",rootPage:(await f(p,{query:{f:"json",token:t},responseType:"json",signal:i})).data,rootIndex:o.rootIndex,pageSize:o.nodesPerPage,lodMetric:o.lodSelectionMetricType,urlPrefix:e}}catch(c){g(a)&&a.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",p,c),s=c}}if(!r)return null;const d=`${n}/nodes/`,l=d+(r&&r.split("/").pop());try{return{type:"node",rootNode:(await f(l,{query:{f:"json",token:t},responseType:"json",signal:i})).data,urlPrefix:d}}catch(e){throw new u("sceneservice:root-node-missing","Root node missing.",{pageError:s,nodeError:e,url:l})}}export{P as n};
