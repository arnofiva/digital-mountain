import{a as $}from"./common-d0b63c2d.js";import{s as y,a as w}from"./Error-685fdf30.js";import{t as v}from"./typedArrayUtil-ce39e5f4.js";import{q as x,C as S,B as _,v as A}from"./quantizationUtils-dc028b68.js";function F(){const r=new Float32Array(6);return r[0]=1,r[3]=1,r}function O(r){const e=new Float32Array(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function j(r,e,n,o,u,s){const c=new Float32Array(6);return c[0]=r,c[1]=e,c[2]=n,c[3]=o,c[4]=u,c[5]=s,c}function G(r,e){return new Float32Array(r,e,6)}function d(r,e,n,o){const u=e[o],s=e[o+1];r[o]=n[0]*u+n[2]*s+n[4],r[o+1]=n[1]*u+n[3]*s+n[5]}function P(r,e,n,o=0,u=0,s=2){const c=u||e.length/s;for(let a=o;a<c;a++)d(r,e,n,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:O,create:F,createView:G,fromValues:j,transform:d,transformMany:P},Symbol.toStringTag,{value:"Module"}));function q(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function T(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function z(r,e,n,o,u,s,c){return r[0]=e,r[1]=n,r[2]=o,r[3]=u,r[4]=s,r[5]=c,r}function D(r,e){const n=e[0],o=e[1],u=e[2],s=e[3],c=e[4],a=e[5];let t=n*s-o*u;return t?(t=1/t,r[0]=s*t,r[1]=-o*t,r[2]=-u*t,r[3]=n*t,r[4]=(u*a-s*c)*t,r[5]=(o*c-n*a)*t,r):null}function L(r){return r[0]*r[3]-r[1]*r[2]}function p(r,e,n){const o=e[0],u=e[1],s=e[2],c=e[3],a=e[4],t=e[5],i=n[0],f=n[1],m=n[2],h=n[3],M=n[4],l=n[5];return r[0]=o*i+s*f,r[1]=u*i+c*f,r[2]=o*m+s*h,r[3]=u*m+c*h,r[4]=o*M+s*l+a,r[5]=u*M+c*l+t,r}function V(r,e,n){const o=e[0],u=e[1],s=e[2],c=e[3],a=e[4],t=e[5],i=Math.sin(n),f=Math.cos(n);return r[0]=o*f+s*i,r[1]=u*f+c*i,r[2]=o*-i+s*f,r[3]=u*-i+c*f,r[4]=a,r[5]=t,r}function B(r,e,n){const o=e[0],u=e[1],s=e[2],c=e[3],a=e[4],t=e[5],i=n[0],f=n[1];return r[0]=o*i,r[1]=u*i,r[2]=s*f,r[3]=c*f,r[4]=a,r[5]=t,r}function C(r,e,n){const o=e[0],u=e[1],s=e[2],c=e[3],a=e[4],t=e[5],i=n[0],f=n[1];return r[0]=o,r[1]=u,r[2]=s,r[3]=c,r[4]=o*i+s*f+a,r[5]=u*i+c*f+t,r}function E(r,e){const n=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=n,r[2]=-n,r[3]=o,r[4]=0,r[5]=0,r}function R(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r}function U(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function Z(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function k(r){return Math.sqrt(r[0]**2+r[1]**2+r[2]**2+r[3]**2+r[4]**2+r[5]**2+1)}function H(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r}function g(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r}function I(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r}function J(r,e,n,o){return r[0]=e[0]+n[0]*o,r[1]=e[1]+n[1]*o,r[2]=e[2]+n[2]*o,r[3]=e[3]+n[3]*o,r[4]=e[4]+n[4]*o,r[5]=e[5]+n[5]*o,r}function K(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]}function N(r,e){const n=r[0],o=r[1],u=r[2],s=r[3],c=r[4],a=r[5],t=e[0],i=e[1],f=e[2],m=e[3],h=e[4],M=e[5],l=$();return Math.abs(n-t)<=l*Math.max(1,Math.abs(n),Math.abs(t))&&Math.abs(o-i)<=l*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(u-f)<=l*Math.max(1,Math.abs(u),Math.abs(f))&&Math.abs(s-m)<=l*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-h)<=l*Math.max(1,Math.abs(c),Math.abs(h))&&Math.abs(a-M)<=l*Math.max(1,Math.abs(a),Math.abs(M))}const Q=p,W=g;Object.freeze(Object.defineProperty({__proto__:null,add:H,copy:q,determinant:L,equals:N,exactEquals:K,frob:k,fromRotation:E,fromScaling:R,fromTranslation:U,identity:T,invert:D,mul:Q,multiply:p,multiplyScalar:I,multiplyScalarAndAdd:J,rotate:V,scale:B,set:z,str:Z,sub:W,subtract:g,translate:C},Symbol.toStringTag,{value:"Module"}));function ur(r,e,n,o,u){if(v(r))return null;const s=r.referencesGeometry()&&u?X(e,o,u):e,c=r.repurposeFeature(s);try{return r.evaluate({...n,$feature:c})}catch(a){return y.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}const b=new Map;function X(r,e,n){const{transform:o,hasZ:u,hasM:s}=n;b.has(e)||b.set(e,Y(e));const c=b.get(e)(r.geometry,o,u,s);return{...r,geometry:c}}function Y(r){const e={};switch(r){case"esriGeometryPoint":return(n,o,u,s)=>A(o,e,n,u,s);case"esriGeometryPolygon":return(n,o,u,s)=>_(o,e,n,u,s);case"esriGeometryPolyline":return(n,o,u,s)=>S(o,e,n,u,s);case"esriGeometryMultipoint":return(n,o,u,s)=>x(o,e,n,u,s);default:return y.getLogger("esri.views.2d.support.arcadeOnDemand").error(new w("mapview-arcade",`Unable to handle geometryType: ${r}`)),n=>n}}export{T as a,ur as b,B as c,P as d,V as e,U as f,E as h,C as i,F as n,p as o,D as r};
