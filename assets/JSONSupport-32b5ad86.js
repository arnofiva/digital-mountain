import{p as Z,b as gt,h as De,w as Pe,o as N}from"./string-7a2f1d87.js";import{e as Ht,t as Ue,m as Me,S as jt,_ as ze,B as xe,k as Kt,M as Et,$ as Re,w as Ge,j as Le,b as Bt}from"./ensureType-249b88cd.js";import{N as $,r as C,F as Ve,m as Fe,J as Je,K as St,L as qe,a as He,t as Tt,j as Ke}from"./typedArrayUtil-70e1d79e.js";import{s as O,a as yt,b as Be}from"./Error-62cc7aff.js";import{t as Wt}from"./nextTick-3ee5a785.js";import{D as We,p as Ze,a as Xe}from"./promiseUtils-59dab60c.js";function Zt(e,t,r,s){var n,i=arguments.length,a=i<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function zs(e){const t=[];return function*(){yield*t;for(const r of e)t.push(r),yield r}}function xs(e,t){for(const r of e)if(r!=null&&t(r))return r}function kt(e){return e!=null&&typeof e[Symbol.iterator]=="function"}let Qe=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach(r=>{t+=r.length}),t}add(t,r){if(kt(t)){const s=this._getOrCreateGroup(r);for(const n of t)this._isHandle(n)&&s.push(n)}else this._isHandle(t)&&this._getOrCreateGroup(r).push(t);return this}forEach(t,r){if(typeof t=="function")this._groups.forEach(s=>s.forEach(t));else{const s=this._getGroup(t);s&&r&&s.forEach(r)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(typeof t!="string"&&kt(t)){for(const r of t)this.remove(r);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach(t=>this._removeAllFromGroup(t)),this._groups.clear(),this}_isHandle(t){return t&&!!t.remove}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const r=[];return this._groups.set(this._ensureGroupKey(t),r),r}_getGroup(t){return $(this._groups.get(this._ensureGroupKey(t)))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){t.forEach(r=>r.remove())}};const Xt=Symbol("Accessor-beforeDestroy");function Ye(e){return _t(()=>e.forEach(t=>C(t)&&t.remove()))}function _t(e){return{remove:()=>{e&&(e(),e=void 0)}}}function Gs(e){return _t(()=>{const t=e();C(t)&&t.remove()})}function Ls(e){return _t(C(e)?()=>e.destroy():void 0)}function b(e){return e?e.__accessor__?e.__accessor__:e.propertyInvalidated?e:null:null}function tr(e,t){return e!=null&&e.metadatas&&e.metadatas[t]!=null}function M(e,t,r){return r?G(e,t,{policy:r,path:""}):G(e,t,null)}function G(e,t,r){return t?Object.keys(t).reduce((s,n)=>{let i=null,a="merge";if(r&&(i=r.path?`${r.path}.${n}`:n,a=r.policy(i)),a==="replace"||a==="replace-arrays"&&Array.isArray(s[n]))return s[n]=t[n],s;if(s[n]===void 0)return s[n]=Z(t[n]),s;let o=s[n],c=t[n];if(o===c)return s;if(Array.isArray(c)||Array.isArray(s))o=o?Array.isArray(o)?s[n]=o.concat():s[n]=[o]:s[n]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{o.includes(u)||o.push(u)}));else if(c&&typeof c=="object")if(r){const u=r.path;r.path=$(i),s[n]=G(o,c,r),r.path=u}else s[n]=G(o,c,null);else s.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(s[n]=c);return s},e||{}):e}function Qt(e){return Array.isArray(e)?e:e.split(".")}function Nt(e){return e.includes(",")?e.split(",").map(t=>t.trim()):[e.trim()]}function er(e){if(Array.isArray(e)){const t=[];for(const r of e)t.push(...Nt(r));return t}return Nt(e)}function Yt(e,t,r,s){const n=er(t);if(n.length!==1){const i=n.map(a=>s(e,a,r));return Ye(i)}return s(e,n[0],r)}function te(e){let t=!1;return()=>{t||(t=!0,e())}}function ee(e,t){const r=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(r,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.getItemAt(n)}const s=b(t);return tr(s,r)?s.get(r):t[r]}function re(e,t,r){if(e==null)return e;const s=ee(t[r],e);return!s&&r<t.length-1?void 0:r===t.length-1?s:re(s,t,r+1)}function I(e,t,r=0){return typeof t!="string"||t.includes(".")?re(e,Qt(t),r):ee(t,e)}function L(e,t){return I(e,t)}function Ct(e,t){return I(t,e)!==void 0}function D(e){let t=e.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){t=Object.create(t);for(const s in t)t[s]=Z(t[s]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return $(e.constructor.__accessorMetadata__)}function X(e,t){const r=D(e);let s=r[t];return s||(s=r[t]={}),s}function rr(e,t){return M(e,t,nr)}const sr=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function nr(e){return sr.test(e)?"replace":"merge"}var g;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED"})(g||(g={}));let ir=class{constructor(t,r){this._observers=t,this._observer=r}remove(){Ve(this._observers,this._observer)}},or=class{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return ar;this._observers==null&&(this._observers=[]);const r=this._observers;let s=!1,n=!1;const i=r.length;for(let a=0;a<i;++a){const o=r[a];if(o.destroyed)n=!0;else if(o===t){s=!0;break}}return s||(r.push(t),n&&this._removeDestroyedObservers()),new ir(r,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||t.length===0)return;const r=t.length;let s=0;for(let n=0;n<r;++n){for(;n+s<r&&t[n+s].destroyed;)++s;if(s>0){if(!(n+s<r))break;t[n]=t[n+s]}}t.length=r-s}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(t!=null){for(const r of t)r.onCommitted();this._observers=null}}};const ar={remove:()=>{}};var d;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.USER=6]="USER"})(d||(d={}));const Js=d.USER+1;function se(e){switch(e){case"defaults":return d.DEFAULTS;case"service":return d.SERVICE;case"portal-item":return d.PORTAL_ITEM;case"web-scene":return d.WEB_SCENE;case"web-map":return d.WEB_MAP;case"user":return d.USER;default:return null}}function st(e){switch(e){case d.DEFAULTS:return"defaults";case d.SERVICE:return"service";case d.PORTAL_ITEM:return"portal-item";case d.WEB_SCENE:return"web-scene";case d.WEB_MAP:return"web-map";case d.USER:return"user"}return $(void 0)}function cr(e){return st(e)}var h;(function(e){e[e.Dirty=1]="Dirty",e[e.Overriden=2]="Overriden",e[e.Computing=4]="Computing",e[e.NonNullable=8]="NonNullable",e[e.HasDefaultValue=16]="HasDefaultValue",e[e.DepTrackingInitialized=32]="DepTrackingInitialized",e[e.AutoTracked=64]="AutoTracked",e[e.ExplicitlyTracking=128]="ExplicitlyTracking"})(h||(h={}));const V={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},j=[];let E=V;function Q(e){E.onObservableAccessed(e)}let z=!1,x=!1;function _(e,t,r){if(z)return vt(e,t,r);ne(e);const s=t.call(r);return ie(),s}function lr(e,t){return _(V,e,t)}function vt(e,t,r){const s=z;z=!0,ne(e);let n=null;try{n=t.call(r)}catch(i){x&&O.getLogger("esri.core.accessorSupport.tracking").error(i)}return ie(),z=s,n}function ne(e){E=e,j.push(e)}function ie(){const e=j.length;if(e>1){const t=j.pop();E=j[e-2],t.onTrackingEnd()}else if(e===1){const t=j.pop();E=V,t.onTrackingEnd()}else E=V}function oe(e,t){const r=t.observerObject;if(r.flags&h.DepTrackingInitialized)return;const s=x;x=!1,r.flags&h.AutoTracked?vt(t,t.metadata.get,e):ae(e,t),x=s}const ur=[];function ae(e,t){const r=t.observerObject;r.flags&h.ExplicitlyTracking||(r.flags|=h.ExplicitlyTracking,vt(t,()=>{const s=t.metadata.dependsOn||ur;for(const n of s)if(typeof n!="string"||n.includes(".")){const i=Qt(n);for(let a=0,o=e;a<i.length&&o!=null&&typeof o=="object";++a)o=It(o,i[a],a!==i.length-1)}else It(e,n,!1)}),r.flags&=~h.ExplicitlyTracking)}function It(e,t,r){var i;const s=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const a=parseInt(s,10);if(!isNaN(a))return Array.isArray(e)?e[a]:e.getItemAt(a)}const n=(i=b(e))==null?void 0:i.properties.get(s);return n&&(Q(n.observerObject),oe(e,n)),r?e[s]:void 0}let Dt=class{constructor(t,r,s){this.properties=t,this.propertyName=r,this.metadata=s,this.observerObject=new hr,this._accessed=null,this._handles=null,this.observerObject.flags=h.Dirty|(s.nonNullable?h.NonNullable:0)|(s.hasOwnProperty("value")?h.HasDefaultValue:0)|(s.get===void 0?h.DepTrackingInitialized:0)|(s.dependsOn===void 0?h.AutoTracked:0),Pt.register(this,this.observerObject)}destroy(){this.observerObject.destroy(),this._accessed=null,this._clearObservationHandles(),Pt.unregister(this)}getComputed(){const t=this.observerObject;Q(t);const r=this.properties.store,s=this.propertyName,n=t.flags,i=r.get(s);if(n&h.Computing||~n&h.Dirty&&r.has(s))return i;t.flags|=h.Computing;const a=this.properties.host;let o;n&h.AutoTracked?o=_(this,this.metadata.get,a):(ae(a,this),o=this.metadata.get.call(a)),r.set(s,o,d.COMPUTED);const c=r.get(s);return c===i?t.flags&=~h.Dirty:lr(this.commit,this),t.flags&=~h.Computing,c}onObservableAccessed(t){t!==this.observerObject&&(this._accessed===null&&(this._accessed=[]),this._accessed.includes(t)||this._accessed.push(t))}onTrackingEnd(){this._clearObservationHandles();const t=this.observerObject;t.flags|=h.DepTrackingInitialized;const r=this._accessed;if(r===null)return;let s=this._handles;s===null&&(s=this._handles=[]);for(let n=0;n<r.length;++n)s.push(r[n].observe(t));r.length=0}notifyChange(){const t=this.observerObject;t.onInvalidated(),t.onCommitted()}invalidate(){this.observerObject.onInvalidated()}commit(){const t=this.observerObject;t.flags&=~h.Dirty,t.onCommitted()}_clearObservationHandles(){const t=this._handles;if(t!==null){for(let r=0;r<t.length;++r)t[r].remove();t.length=0}}},hr=class extends or{constructor(){super(...arguments),this.flags=0}onInvalidated(){~this.flags&h.Overriden&&(this.flags|=h.Dirty);const t=this._observers;if(t&&t.length>0)for(const r of t)r.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const r=t.slice();for(const s of r)s.onCommitted()}}destroy(){this.flags&h.Dirty&&this.onCommitted(),super.destroy()}};const Pt=new FinalizationRegistry(e=>{e.destroy()});let fr=class ce{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const r=new ce;return this._values.forEach((s,n)=>{t&&t.has(n)||r.set(n,Z(s))}),r}get(t){return this._values.get(t)}originOf(){return d.USER}keys(){return[...this._values.keys()]}set(t,r){this._values.set(t,r)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}};function P(e,t,r){return e!==void 0}function Ut(e,t,r,s){return e!==void 0&&(!(r==null&&e.observerObject.flags&h.NonNullable)||(s.lifecycle,g.INITIALIZING,!1))}function dr(e){return e&&typeof e.destroy=="function"}O.getLogger("esri.core.accessorSupport.Properties");class pr{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=g.INITIALIZING,this.store=new fr,this._origin=d.USER;const r=$(this.host.constructor.__accessorMetadata__);for(const s in r){const n=new Dt(this,s,r[s]);this.properties.set(s,n)}this.metadatas=r}initialize(){this.lifecycle=g.CONSTRUCTING}constructed(){this.lifecycle=g.CONSTRUCTED}destroy(){this.destroyed=!0;for(const[t,r]of this.properties){if(r.metadata.autoDestroy){const s=this.internalGet(t);s&&dr(s)&&(s.destroy(),~r.observerObject.flags&h.NonNullable&&this._internalSet(r,null))}r.destroy()}}get initialized(){return this.lifecycle!==g.INITIALIZING}get(t){const r=this.properties.get(t);if(r.metadata.get)return r.getComputed();Q(r.observerObject);const s=this.store;return s.has(t)?s.get(t):r.metadata.value}originOf(t){const r=this.store.originOf(t);if(r===void 0){const s=this.properties.get(t);if(s!==void 0&&s.observerObject.flags&h.HasDefaultValue)return"defaults"}return st(r)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const r=this.properties.get(t);if(P(r))return this.store.has(t)?this.store.get(t):r.metadata.value}internalSet(t,r){const s=this.properties.get(t);P(s)&&this._internalSet(s,r)}getDependsInfo(t,r,s){const n=this.properties.get(r);if(!P(n))return"";const i=new Set,a=_({onObservableAccessed:c=>i.add(c),onTrackingEnd:()=>{}},()=>{var c;return(c=n.metadata.get)==null?void 0:c.call(t)});let o=`${s}${t.declaredClass.split(".").pop()}.${r}: ${a}
`;if(i.size===0)return o;s+="  ";for(const c of i){if(!(c instanceof Dt))continue;const u=c.properties.host,l=c.propertyName,f=b(u);o+=f?f.getDependsInfo(u,l,s):`${s}${l}: undefined
`}return o}setAtOrigin(t,r,s){const n=this.properties.get(t);if(P(n))return this._setAtOrigin(n,r,s)}isOverridden(t){const r=this.properties.get(t);return r!==void 0&&!!(r.observerObject.flags&h.Overriden)}clearOverride(t){const r=this.properties.get(t),s=r==null?void 0:r.observerObject;s&&s.flags&h.Overriden&&(s.flags&=~h.Overriden,r.notifyChange())}override(t,r){const s=this.properties.get(t);if(!Ut(s,t,r,this))return;const n=s.metadata.cast;if(n){const i=this._cast(n,r),{valid:a,value:o}=i;if(Y.release(i),!a)return;r=o}s.observerObject.flags|=h.Overriden,this._internalSet(s,r)}set(t,r){const s=this.properties.get(t);if(!Ut(s,t,r,this))return;const n=s.metadata.cast;if(n){const a=this._cast(n,r),{valid:o,value:c}=a;if(Y.release(a),!o)return;r=c}const i=s.metadata.set;i?i.call(this.host,r):this._internalSet(s,r)}setDefaultOrigin(t){this._origin=se(t)}getDefaultOrigin(){return st(this._origin)}notifyChange(t){const r=this.properties.get(t);r!==void 0&&r.notifyChange()}invalidate(t){const r=this.properties.get(t);r!==void 0&&r.invalidate()}commit(t){const r=this.properties.get(t);r!==void 0&&r.commit()}_internalSet(t,r){const s=this.lifecycle!==g.INITIALIZING?this._origin:d.DEFAULTS;this._setAtOrigin(t,r,s)}_setAtOrigin(t,r,s){const n=this.store,i=t.propertyName;n.has(i,s)&&gt(r,n.get(i))&&~t.observerObject.flags&h.Overriden&&s===n.originOf(i)||(t.invalidate(),n.set(i,r,s),t.commit(),oe(this.host,t))}_cast(t,r){const s=Y.acquire();return s.valid=!0,s.value=r,t&&(s.value=t.call(this.host,r,s)),s}}let gr=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const Y=new Ht(gr);function F(e,t,r){if(e&&t)if(typeof t=="object")for(const s of Object.getOwnPropertyNames(t))F(e,s,t[s]);else{if(t.includes(".")){const n=t.split("."),i=n.splice(n.length-1,1)[0];return void F(L(e,n),i,r)}const s=e.__accessor__;s!=null&&yr(t,s),e[t]=r}}function yr(e,t){if(De("esri-unknown-property-errors")&&!_r(e,t))throw new yt("set:unknown-property",vr(e,t))}function _r(e,t){return t.metadatas[e]!=null}function vr(e,t){return"setting unknown property '"+e+"' on instance of "+t.host.declaredClass}let mr=class extends Ht{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=Fe(this._set)}acquire(...t){const r=super.acquire(...t);return this._set.delete(r),r}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}},le=class{constructor(t,r=30){this.name=t,this._counter=0,this._samples=new Array(r)}record(t){C(t)&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,r)=>t-r)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,r)=>t+r,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var nt;(function(e){const t=(i,a,o,c)=>{let u=a,l=a;const f=o>>>1,p=i[u-1];for(;l<=f;){l=u<<1,l<o&&c(i[l-1],i[l])<0&&++l;const At=i[l-1];if(c(At,p)<=0)break;i[u-1]=At,u=l}i[u-1]=p},r=(i,a)=>i<a?-1:i>a?1:0;function s(i,a,o,c){a===void 0&&(a=0),o===void 0&&(o=i.length),c===void 0&&(c=r);for(let l=o>>>1;l>a;l--)t(i,l,o,c);const u=a+1;for(let l=o-1;l>a;l--){const f=i[a];i[a]=i[l],i[l]=f,t(i,u,l,c)}}function*n(i,a,o,c){a===void 0&&(a=0),o===void 0&&(o=i.length),c===void 0&&(c=r);for(let l=o>>>1;l>a;l--)t(i,l,o,c),yield;const u=a+1;for(let l=o-1;l>a;l--){const f=i[a];i[a]=i[l],i[l]=f,t(i,u,l,c),yield}}e.sort=s,e.iterableSort=n})(nt||(nt={}));const Mt=nt,$r=1.5,br=1.1;let ue=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Je,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>zt(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const r=new Array;for(let s=0;s<this._length;s++){const n=this.data[s];t(n)&&r.push(n)}return r}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}includes(t,r){const s=this.data.indexOf(t,r);return s!==-1&&s<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let r=t;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,r=t.length){for(let s=0;s<r;s++)this.data[this._length++]=t[s]}fill(t,r){for(let s=0;s<r;s++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,zt(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const r=St(this.data,t,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(St(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,r=t.length,s){this.length=qe(this.data,t,this.length,r,this._hint,s),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,r){if(t>=this.length||r>=this.length||t===r)return;const s=this.data[t];this.data[t]=this.data[r],this.data[r]=s}sort(t){Mt.sort(this.data,0,this.length,t)}iterableSort(t){return Mt.iterableSort(this.data,0,this.length,t)}some(t,r){for(let s=0;s<this.length;++s)if(t.call(r,this.data[s],s,this.data))return!0;return!1}find(t,r){for(let s=0;s<this.length;++s){const n=this.data[s];if(t.call(r,n,s))return n}}filterInPlace(t,r){let s=0;for(let n=0;n<this._length;++n){const i=this.data[n];t.call(r,i,n,this.data)&&(this.data[n]=this.data[s],this.data[s]=i,s++)}if(this._deallocator)for(let n=s;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=s,this._shrink(),this}forAll(t,r){const s=this.length,n=this.data;for(let i=0;i<s;++i)t.call(r,n[i],i,n)}forEach(t,r){for(let s=0;s<this.length;++s)t.call(r,this.data[s],s,this.data)}map(t,r){const s=new Array(this.length);for(let n=0;n<this.length;++n)s[n]=t.call(r,this.data[n],n,this.data);return s}reduce(t,r){let s=r;for(let n=0;n<this.length;++n)s=t(s,this.data[n],n,this.data);return s}has(t){const r=this.length,s=this.data;for(let n=0;n<r;++n)if(s[n]===t)return!0;return!1}};function zt(e){e.data.length>$r*e.length&&(e.data.length=Math.floor(e.length*br))}function Xs(e){return e}function Qs(e){return 1e3*e}function Ys(e){return e}function tn(e){return .001*e}let wr=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},Or=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},it=0,ot=0;const A={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},at=["prepare","preRender","render","postRender","update","finish"],ct=[],m=new ue;let Ar=class{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};const J={frameTasks:m,willDispatch:!1,clearFrameTasks:Er,dispatch:de,executeFrameTasks:Sr};function jr(e){const t=new Or(e);return ct.push(t),J.willDispatch||(J.willDispatch=!0,Wt(de)),t}function nn(e){const t=new wr(e);return m.push(t),q==null&&(it=performance.now(),q=requestAnimationFrame(he)),new Ar(t)}let q=null;function Er(e=!1){m.forAll(t=>{t.removed=!0}),e&&fe()}function on(e){ot=Math.max(0,e)}function he(){const e=performance.now();q=null,q=m.length>0?requestAnimationFrame(he):null,J.executeFrameTasks(e)}function Sr(e){const t=e-it;it=e;const r=ot>0?ot:1e3/60,s=Math.max(0,t-r);A.time=e,A.frameDuration=r-s;for(let n=0;n<at.length;n++){const i=performance.now(),a=at[n];m.forAll(o=>{var c;o.paused||o.removed||(n===0&&o.ticks++,o.phases[a]&&(A.elapsedFrameTime=performance.now()-e,A.deltaTime=o.ticks===0?0:t,(c=o.phases[a])==null||c.call(o,A)))}),Tr[n].record(performance.now()-i)}fe(),kr.record(performance.now()-e)}const U=new ue;function fe(){m.forAll(e=>{e.removed&&U.push(e)}),m.removeUnorderedMany(U.data,U.length),U.clear()}function de(){for(;ct.length;){const e=$(ct.shift());e.isActive&&e.callback()}J.willDispatch=!1}function an(e=1,t){const r=We(),s=()=>{Ze(t)?r.reject(Xe()):e===0?r():(--e,Wt(()=>s()))};return s(),r.promise}const Tr=at.map(e=>new le(e)),kr=new le("total");function Nr(e,t){for(const r of e.entries())if(t(r[0]))return!0;return!1}let Cr=0;const cn=0;function tt(){return++Cr}let mt=class{constructor(t){this._notify=t,this._accessed=[],this._handles=[],this._observerObject=new Ir(this._notify),xt.register(this,this._observerObject)}destroy(){var t;this._accessed.length=0,(t=this._observerObject)==null||t.destroy(),this.clear(),xt.unregister(this)}onObservableAccessed(t){const r=this._accessed;r.includes(t)||r.push(t)}onTrackingEnd(){const t=this._handles,r=this._accessed,s=this._observerObject;for(let n=0;n<r.length;++n)t.push(r[n].observe(s));r.length=0}clear(){const t=this._handles;for(let r=0;r<t.length;++r)t[r].remove();t.length=0}},Ir=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=Dr}};const xt=new FinalizationRegistry(e=>{e.destroy()});function Dr(){}let w=!1;const H=[];function pe(e,t){let r=new mt(i),s=null,n=!1;function i(){if(!r||n)return;if(w)return void ye(i);const o=s;r.clear(),w=!0,n=!0,s=_(r,e),n=!1,w=!1,t(s,o),_e()}function a(){r&&(r.destroy(),r=null,s=null)}return n=!0,s=_(r,e),n=!1,{remove:a}}function ge(e,t){let r=new mt(n),s=null;function n(){t(s,a)}function i(){r&&(r.destroy(),r=null),s=null}function a(){return r?(r.clear(),s=_(r,e),s):null}return a(),{remove:i}}function hn(e){let t=new mt(s),r=!1;function s(){t&&!r&&(w?ye(s):(t.clear(),w=!0,r=!0,_(t,e),r=!1,w=!1,_e()))}function n(){t&&(t.destroy(),t=null)}return r=!0,_(t,e),r=!1,{remove:n}}function ye(e){H.includes(e)||H.unshift(e)}function _e(){for(;H.length;)H.pop()()}var S;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(S||(S={}));let T=class{constructor(){this.uid=tt(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,r,s,n,i){return this.pool.acquire(S.Untracked,t,r,s,n,i,gt)}static acquireTracked(t,r,s,n){return this.pool.acquire(S.Tracked,t,r,s,null,null,n)}notify(t,r){this.type===S.Untracked?this.callback.call(this.target,t,r,this.path,this.target):this.callback.call(null,t,r)}acquire(t,r,s,n,i,a,o){this.uid=tt(),this.removed=!1,this.type=t,this.oldValue=r,this.callback=s,this.getValue=n,this.target=i,this.path=a,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=tt(),this.removed=!0}};T.pool=new mr(T);const R=new Ue,y=new Set;let K;function B(e){y.delete(e),y.add(e),K||(K=jr(Mr))}function Pr(e){if(e.removed)return;const t=e.oldValue,r=e.getValue();e.equals(t,r)||(e.oldValue=r,e.notify(r,t))}function Ur(e){for(const t of y.values())t.target===e&&(t.removed=!0)}function Mr(){let e=10;for(;K&&e--;){K=null;const t=zr(),r=R.acquire();for(const s of t){const n=s.uid;Pr(s),n===s.uid&&s.removed&&r.push(s)}for(const s of y)s.removed&&(r.push(s),y.delete(s));for(const s of r)T.pool.release(s);R.release(r),R.release(t),lt.forEach(s=>s())}}function zr(){const e=R.acquire();e.length=y.size;let t=0;for(const r of y)e[t]=r,++t;return y.clear(),e}const lt=new Set;function dn(e){return lt.add(e),{remove(){lt.delete(e)}}}function xr(e,t,r){let s=Yt(e,t,r,(n,i,a)=>{let o,c,u=ge(()=>I(n,i),(l,f)=>{n.__accessor__.destroyed||o&&o.uid!==c?s.remove():(o||(o=T.acquireUntracked(l,a,f,n,i),c=o.uid),B(o))});return{remove:te(()=>{u.remove(),o&&(o.uid!==c||o.removed||(o.removed=!0,B(o)),o=null),s=u=null})}});return s}function Rr(e,t,r){const s=Yt(e,t,r,(n,i,a)=>{let o=!1;return pe(()=>I(n,i),(c,u)=>{n.__accessor__.destroyed?s.remove():o||(o=!0,gt(u,c)||a.call(n,c,u,i,n),o=!1)})});return s}function Gr(e,t,r,s=!1){return!e.__accessor__||e.__accessor__.destroyed?{remove(){}}:s?Rr(e,t,r):xr(e,t,r)}function Lr(e,t,r){let s,n,i=ge(e,(a,o)=>{s&&s.uid!==n?i.remove():(s||(s=T.acquireTracked(a,t,o,r),n=s.uid),B(s))});return{remove:te(()=>{i.remove(),s&&(s.uid!==n||s.removed||(s.removed=!0,B(s)),s=null),i=null})}}function Vr(e,t,r){let s=!1;return pe(e,(n,i)=>{s||(s=!0,r(i,n)||t(n,i),s=!1)})}function pn(e,t,r=!1,s=Pe){return r?Vr(e,t,s):Lr(e,t,s)}function gn(e){return Nr(y,t=>t.oldValue===e)}function Fr(e={}){return(t,r)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${r}. Accessor does not support static properties.`);const s=Object.getOwnPropertyDescriptor(t,r),n=X(t,r);s&&(s.get||s.set?(n.get=s.get||n.get,n.set=s.set||n.set):"value"in s&&("value"in e&&O.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${t.constructor.name}" already defined in the metadata`,e),n.value=e.value=s.value)),e.readOnly!=null&&(n.readOnly=e.readOnly);const i=e.aliasOf;if(i){const c=typeof i=="string"?i:i.source,u=typeof i=="string"?null:i.overridable===!0;let l;n.dependsOn=[c],n.get=function(){let f=L(this,c);if(typeof f=="function"){l||(l=c.split(".").slice(0,-1).join("."));const p=L(this,l);p&&(f=f.bind(p))}return f},n.readOnly||(n.set=u?function(f){this._override(r,f)}:function(f){F(this,c,f)})}const a=e.type,o=e.types;n.cast||(a?n.cast=Jr(a):o&&(Array.isArray(o)?n.cast=Me(jt(o[0])):n.cast=jt(o))),rr(n,e),e.range&&(n.cast=qr(n.cast,e.range))}}function yn(e,t,r){const s=X(e,r);s.json||(s.json={});let n=s.json;return t!==void 0&&(n.origins||(n.origins={}),n.origins[t]||(n.origins[t]={}),n=n.origins[t]),n}function Jr(e){let t=0,r=e;if(ze(e))return xe(e);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],t++;const s=r;if(Kt(s))return t===0?Et(s):Re(Et(s),t);if(t===1)return Ge(s);if(t>1)return Le(s,t);const n=e;return n.from?n.from:Bt(n)}function qr(e,t){return r=>{let s=+e(r);return t.step!=null&&(s=Math.round(s/t.step)*t.step),t.min!=null&&(s=Math.max(t.min,s)),t.max!=null&&(s=Math.min(t.max,s)),s}}function Hr(e){if(e.json&&e.json.origins){const t=e.json.origins,r={"web-document":["web-scene","web-map"]};for(const s in r)if(t[s]){const n=t[s];r[s].forEach(i=>{t[i]=n}),delete t[s]}}}let ve=class ut extends Be{constructor(t,r,s){if(super(t,r,s),!(this instanceof ut))return new ut(t,r,s)}};ve.prototype.type="warning";function me(e){return!!e&&e.prototype&&e.prototype.declaredClass&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}const ht=O.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Rt(e,t,r){var s,n;e&&(!r&&!t.read||(s=t.read)!=null&&s.reader||((n=t.read)==null?void 0:n.enabled)===!1||Zr(e)&&N("read.reader",Kr(e),t))}function Kr(e){var r,s;const t=e.ndimArray??0;if(t>1)return Wr(e);if(t===1)return Gt(e);if("type"in e&&be(e.type)){const n=(s=(r=e.type.prototype)==null?void 0:r.itemType)==null?void 0:s.Type,i=Gt(typeof n=="function"?{type:n}:{types:n});return(a,o,c)=>{const u=i(a,o,c);return u&&new e.type(u)}}return $t(e)}function $t(e){return"type"in e?Br(e.type):Xr(e.types)}function Br(e){return e.prototype.read?(t,r,s)=>{if(t==null)return t;const n=typeof t;if(n!=="object")return void ht.error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${n}'`);const i=new e;return i.read(t,s),i}:e.fromJSON}function $e(e,t,r,s){return s!==0&&Array.isArray(t)?t.map(n=>$e(e,n,r,s-1)):e(t,void 0,r)}function Wr(e){const t=$t(e),r=$e.bind(null,t),s=e.ndimArray??0;return(n,i,a)=>{if(n==null)return n;n=r(n,a,s);let o=s,c=n;for(;o>0&&Array.isArray(c);)o--,c=c[0];if(c!==void 0)for(let u=0;u<o;u++)n=[n];return n}}function Gt(e){const t=$t(e);return(r,s,n)=>{if(r==null)return r;if(Array.isArray(r)){const a=[];for(const o of r){const c=t(o,void 0,n);c!==void 0&&a.push(c)}return a}const i=t(r,void 0,n);return i!==void 0?[i]:void 0}}function be(e){if(!me(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?bt(t.Type):we(t.Type))}function Zr(e){return"types"in e?we(e.types):bt(e.type)}function bt(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||be(e))}function we(e){for(const t in e.typeMap)if(!bt(e.typeMap[t]))return!1;return!0}function Xr(e){let t=null;const r=e.errorContext??"type";return(s,n,i)=>{if(s==null)return s;const a=typeof s;if(a!=="object")return void ht.error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);t||(t=Qr(e));const o=e.key;if(typeof o!="string")return;const c=s[o],u=c?t[c]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!u){const f=`Type '${c||"unknown"}' is not supported`;return i&&i.messages&&s&&i.messages.push(new ve(`${r}:unsupported`,f,{definition:s,context:i})),void ht.error(f)}const l=new u;return l.read(s,i),l}}function Qr(e){var r,s;const t={};for(const n in e.typeMap){const i=e.typeMap[n],a=D(i.prototype);if(typeof e.key=="function")continue;const o=a[e.key];if(!o)continue;(r=o.json)!=null&&r.type&&Array.isArray(o.json.type)&&o.json.type.length===1&&typeof o.json.type[0]=="string"&&(t[o.json.type[0]]=i);const c=(s=o.json)==null?void 0:s.write;if(!c||!c.writer){t[n]=i;continue}const u=c.target,l=typeof u=="string"?u:e.key,f={};c.writer(n,f,l),f[l]&&(t[f[l]]=i)}return t}function Yr(e){if(e.json||(e.json={}),Vt(e.json),Ft(e.json),Lt(e.json),e.json.origins)for(const t in e.json.origins)Vt(e.json.origins[t]),Ft(e.json.origins[t]),Lt(e.json.origins[t]);return!0}function Lt(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function Vt(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function Ft(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function Jt(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;const r=(e==null?void 0:e.ndimArray)??0;e&&(r===1||"type"in e&&me(e.type))?t.write.writer=ss:r>1?t.write.writer=ns(r):t.types?Array.isArray(t.types)?t.write.writer=es(t.types[0]):t.write.writer=ts(t.types):t.write.writer=k}function ts(e){return(t,r,s,n)=>t?Oe(t,e,n)?k(t,r,s,n):void 0:k(t,r,s,n)}function Oe(e,t,r){for(const s in t.typeMap)if(e instanceof t.typeMap[s])return!0;if(r!=null&&r.messages){const s=t.errorContext??"type",n=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&e&&r.messages.push(new yt(`${s}:unsupported`,n,{definition:e,context:r})),O.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function es(e){return(t,r,s,n)=>!t||!Array.isArray(t)?k(t,r,s,n):k(t.filter(i=>Oe(i,e,n)),r,s,n)}function k(e,t,r,s){N(r,W(e,s),t)}function W(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?rs(e):e}function rs(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function ss(e,t,r,s){let n;e===null?n=null:e&&typeof e.map=="function"?(n=e.map(i=>W(i,s)),typeof n.toArray=="function"&&(n=n.toArray())):n=[W(e,s)],N(r,n,t)}function Ae(e,t,r){return r!==0&&Array.isArray(e)?e.map(s=>Ae(s,t,r-1)):W(e,t)}function ns(e){return(t,r,s,n)=>{let i;if(t===null)i=null;else{i=Ae(t,n,e);let a=e,o=i;for(;a>0&&Array.isArray(o);)a--,o=o[0];if(o!==void 0)for(let c=0;c<a;c++)i=[i]}N(s,i,r)}}function ft(e,t){return wt(e,"read",t)}function je(e,t){return wt(e,"write",t)}function wt(e,t,r){let s=e&&e.json;if(e&&e.json&&e.json.origins&&r){const n=r.origin&&e.json.origins[r.origin];n&&(t==="any"||t in n)&&(s=n)}return s}function is(e){const t=os(e);if(e.json.origins)for(const r in e.json.origins){const s=e.json.origins[r],n=s.types?as(s):t;Rt(n,s,!1),s.types&&!s.write&&e.json.write&&e.json.write.enabled&&(s.write={...e.json.write}),Jt(n,s)}Rt(t,e.json,!0),Jt(t,e.json)}function os(e){return e.json.types?dt(e.json):e.type?Ee(e):dt(e)}function as(e){return e.type?Ee(e):dt(e)}function Ee(e){if(!e.type)return;let t=0,r=e.type;for(;Array.isArray(r)&&!Kt(r);)r=r[0],t++;return{type:r,ndimArray:t}}function dt(e){if(!e.types)return;let t=0,r=e.types;for(;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}function cs(e){Yr(e)&&(Hr(e),is(e))}const et=new Set,rt=new Set;function Ot(e){return t=>{t.prototype.declaredClass=e,us(t);const r=[],s=[];let n=t.prototype;for(;n;)n.hasOwnProperty("initialize")&&!et.has(n.initialize)&&(et.add(n.initialize),r.push(n.initialize)),n.hasOwnProperty("destroy")&&!rt.has(n.destroy)&&(rt.add(n.destroy),s.push(n.destroy)),n=Object.getPrototypeOf(n);et.clear(),rt.clear();class i extends t{constructor(...o){if(super(...o),this.constructor===i&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let c=r.length-1;c>=0;c--)r[c].call(this)}}),s.length){let c=!1;const u=this[Xt];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!c){c=!0,u.call(this);for(let l=0;l<s.length;l++)s[l].call(this)}}})}this.postscript(...o)}}}return i.__accessorMetadata__=D(t.prototype),i.prototype.declaredClass=e,i}}function ls(e,t){return t.get==null?function(){const r=this.__accessor__.properties.get(e);if(r===void 0)return;Q(r.observerObject);const s=this.__accessor__.store;return s.has(e)?s.get(e):r.metadata.value}:function(){const r=this.__accessor__.properties.get(e);if(r!==void 0)return r.getComputed()}}function us(e){const t=e.prototype,r=D(t),s={};for(const n of Object.getOwnPropertyNames(r)){const i=r[n];cs(i),s[n]={enumerable:!0,configurable:!0,get:ls(n,i),set(a){const o=this.__accessor__;if(o!==void 0){if(!Object.isFrozen(this)){if(o.initialized&&i.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${n}' of ${this.declaredClass}`);if(o.lifecycle===g.CONSTRUCTED&&i.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${n}' of ${this.declaredClass}`);o.set(n,a)}}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:a})}}}Object.defineProperties(e.prototype,s)}var Se,Te;function hs(e){var t;if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return(t=e.constructor)!=null&&t.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const v=Symbol("Accessor-Handles"),pt=Symbol("Accessor-Initialized");let fs=class ke{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:s,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const i=this;class a extends i{constructor(...c){super(...c),this.inherited=null,n&&n.apply(this,c)}}D(a.prototype);for(const o in t){const c=t[o];a.prototype[o]=typeof c=="function"?function(...u){const l=this.inherited;let f;this.inherited=function(...p){if(i.prototype[o])return i.prototype[o].apply(this,p)};try{f=c.apply(this,u)}catch(p){throw this.inherited=l,p}return this.inherited=l,f}:t[o]}for(const o in r){const c=hs(r[o]);Fr(c)(a.prototype,o)}return Ot(s)(a)}constructor(...t){if(this[Se]=null,this[Te]=!1,this.constructor===ke)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new pr(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}postscript(t){const r=this.__accessor__,s=r.ctorArgs||t;r.initialize(),s&&(this.set(s),r.ctorArgs=null),r.constructed(),this.initialize(),this[pt]=!0}initialize(){}[Xt](){this[v]=He(this[v])}destroy(){this.destroyed||(Ur(this),this.__accessor__.destroy())}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[pt]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(t){this.get(t)}get(t){return L(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,r){return F(this,t,r),this}watch(t,r,s){return Gr(this,t,r,s)}own(t){this.addHandles(t)}addHandles(t,r){let s=this[v];Tt(s)&&(s=this[v]=new Qe),s.add(t,r)}removeHandles(t){const r=this[v];Tt(r)||r.remove(t)}hasHandles(t){const r=this[v];return!!C(r)&&r.has(t)}_override(t,r){r===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,r)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,r){r==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,r)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,r){return this.__accessor__.internalSet(t,r),this}};Se=v,Te=pt;let ds=class{constructor(t,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=s=>this.fromJSON(s),this.write=(s,n,i)=>{const a=this.toJSON(s);a!==void 0&&N(i,a,n)},this.write.isJSONMapWriter=!0}toJSON(t){if(t==null)return null;if(this._apiToJSON.hasOwnProperty(t)){const r=this._apiToJSON[t];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return t!=null&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const r={};for(const s in t)r[t[s]]=s;return r}_getKeysSorted(t){const r=[];for(const s in t)r.push(s);return r.sort(),r}};function vn(){return function(e,t){return new ds(e,{ignoreUnknown:!0,...t})}}const ps=Object.prototype.toString;function gs(e){const t="__accessorMetadata__"in e?Bt(e):e;return function(...r){if(r.push(t),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return ys.apply(this,r)}}function ys(e,t,r,s){X(e,t).cast=s}function _s(e){return(t,r)=>{X(t,e).cast=t[r]}}function mn(...e){if(e.length!==3||typeof e[1]!="string")return e.length===1&&ps.call(e[0])==="[object Function]"?gs(e[0]):e.length===1&&typeof e[0]=="string"?_s(e[0]):void 0}let vs=class Ne{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const r=new Ne;return this._values.forEach((s,n)=>{t&&t.has(n)||r.set(n,Z(s.value),s.origin)}),r}get(t,r){r=this._normalizeOrigin(r);const s=this._values.get(t);return r==null||(s==null?void 0:s.origin)===r?s==null?void 0:s.value:void 0}originOf(t){var r;return((r=this._values.get(t))==null?void 0:r.origin)??d.USER}keys(t){t=this._normalizeOrigin(t);const r=[...this._values.keys()];return t==null?r:r.filter(s=>{var n;return((n=this._values.get(s))==null?void 0:n.origin)===t})}set(t,r,s){if((s=this._normalizeOrigin(s))===d.DEFAULTS){const n=this._values.get(t);if(n&&n.origin!=null&&n.origin>s)return}this._values.set(t,new ms(r,s))}delete(t,r){var s;(r=this._normalizeOrigin(r))!=null&&((s=this._values.get(t))==null?void 0:s.origin)!==r||this._values.delete(t)}has(t,r){var s;return(r=this._normalizeOrigin(r))!=null?((s=this._values.get(t))==null?void 0:s.origin)===r:this._values.has(t)}forEach(t){this._values.forEach(({value:r},s)=>t(r,s))}_normalizeOrigin(t){if(t!=null)return t===d.DEFAULTS?t:d.USER}};class ms{constructor(t,r){this.value=t,this.origin=r}}function $s(e,t,r){t.keys().forEach(n=>{r.set(n,t.get(n),d.DEFAULTS)});const s=e.metadatas;Object.keys(s).forEach(n=>{e.internalGet(n)&&r.set(n,e.internalGet(n),d.DEFAULTS)})}function bs(e,t,r){if(!e||!e.read||e.read.enabled===!1||!e.read.source)return!1;const s=e.read.source;if(typeof s=="string"){if(s===t||s.includes(".")&&s.indexOf(t)===0&&Ct(s,r))return!0}else for(const n of s)if(n===t||n.includes(".")&&n.indexOf(t)===0&&Ct(n,r))return!0;return!1}function ws(e){return e&&(!e.read||e.read.enabled!==!1&&!e.read.source)}function Os(e,t,r,s,n){let i=ft(t[r],n);ws(i)&&(e[r]=!0);for(const a of Object.getOwnPropertyNames(t))i=ft(t[a],n),bs(i,r,s)&&(e[a]=!0)}function As(e,t,r,s){const n=r.metadatas,i=wt(n[t],"any",s),a=i&&i.default;if(a===void 0)return;const o=typeof a=="function"?a.call(e,t,s):a;o!==void 0&&r.set(t,o)}const Ce={origin:"service"};function js(e,t,r=Ce){if(!t||typeof t!="object")return;const s=b(e),n=s.metadatas,i={};for(const a of Object.getOwnPropertyNames(t))Os(i,n,a,t,r);s.setDefaultOrigin(r.origin);for(const a of Object.getOwnPropertyNames(i)){const o=ft(n[a],r).read,c=o&&o.source;let u;u=c&&typeof c=="string"?I(t,c):t[a],o&&o.reader&&(u=o.reader.call(e,u,t,r)),u!==void 0&&s.set(a,u)}if(!r||!r.ignoreDefaults){s.setDefaultOrigin("defaults");for(const a of Object.getOwnPropertyNames(n))i[a]||As(e,a,s,r)}s.setDefaultOrigin("user")}function $n(e,t,r,s=Ce){var i;const n={...s,messages:[]};r(n),(i=n.messages)==null||i.forEach(a=>{a.type!=="warning"||e.loaded?s&&s.messages&&s.messages.push(a):e.loadWarnings.push(a)})}function Es(e,t,r,s,n){var a,o;const i={};return(o=(a=t.write)==null?void 0:a.writer)==null||o.call(e,s,i,r,n),i}function Ie(e,t,r,s,n,i){if(!s||!s.write)return!1;const a=e.get(r);if(!n&&s.write.overridePolicy){const o=s.write.overridePolicy.call(e,a,r,i);o!==void 0&&(n=o)}if(n||(n=s.write),!n||n.enabled===!1)return!1;if((a===null&&!n.allowNull&&!n.writerEnsuresNonNull||a===void 0)&&n.isRequired){const o=new yt("web-document-write:property-required",`Missing value for required property '${r}' on '${e.declaredClass}'`,{propertyName:r,target:e});return o&&i&&i.messages?i.messages.push(o):o&&!i&&O.getLogger("esri.core.accessorSupport.write").error(o.name,o.message),!1}return!(a===void 0||a===null&&!n.allowNull&&!n.writerEnsuresNonNull||(!t.store.multipleOriginsSupported||t.store.originOf(r)===d.DEFAULTS)&&Ss(e,r,i,s,a)||!n.ignoreOrigin&&i&&i.origin&&t.store.multipleOriginsSupported&&t.store.originOf(r)<se(i.origin))}function Ss(e,t,r,s,n){const i=s.default;if(i===void 0)return!1;if(s.defaultEquals!=null)return s.defaultEquals(n);if(typeof i=="function"){if(Array.isArray(n)){const a=i.call(e,t,r);return Ke(a,n)}return!1}return i===n}function bn(e,t,r,s){const n=b(e),i=n.metadatas,a=je(i[t],s);return!!a&&Ie(e,n,t,a,r,s)}function Ts(e,t,r){var i,a;if(e&&typeof e.toJSON=="function"&&(!e.toJSON.isDefaultToJSON||!e.write))return M(t,e.toJSON(r));const s=b(e),n=s.metadatas;for(const o in n){const c=je(n[o],r);if(!Ie(e,s,o,c,void 0,r))continue;const u=e.get(o),l=Es(e,c,c.write&&typeof c.write.target=="string"?c.write.target:o,u,r);Object.keys(l).length>0&&(t=M(t,l),(a=(i=r==null?void 0:r.resources)==null?void 0:i.pendingOperations)!=null&&a.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then(()=>M(t,l,()=>"replace-arrays"))),r&&r.writtenProperties&&r.writtenProperties.push({target:e,propName:o,oldOrigin:cr(s.store.originOf(o)),newOrigin:r.origin}))}return t}const ks=e=>{let t=class extends e{constructor(...r){super(...r);const s=$(b(this)),n=s.store,i=new vs;s.store=i,$s(s,n,i)}read(r,s){js(this,r,s)}write(r={},s){return Ts(this,r,s)}toJSON(r){return this.write({},r)}static fromJSON(r,s){return Ns.call(this,r,s)}};return t=Zt([Ot("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function Ns(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(e,t),r}let qt=class extends ks(fs){};qt=Zt([Ot("esri.core.JSONSupport")],qt);export{zs as $,nn as A,$n as B,ds as C,d as D,mt as E,on as F,_ as G,vn as H,ve as I,Kr as J,yn as K,Q as L,Js as M,b as N,$s as O,pn as P,js as Q,se as R,st as S,Ts as T,or as U,hn as V,rs as W,bn as X,X as Y,Ls as Z,an as _,Ot as a,Gs as a0,qr as a1,mr as b,dn as c,jr as d,Zt as e,tn as f,Xs as g,Ys as h,ue as i,tt as j,Nr as k,qt as l,cn as m,_t as n,xs as o,le as p,te as q,Qs as r,mn as s,Qe as t,ks as u,fs as v,Ye as w,gn as x,Fr as y,kt as z};
